

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CRYSTALClear package &mdash; CRYSTALClear 0.2.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="canonical" href="https://crystaldevs.github.io/CRYSTALClear/CRYSTALClear.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=cb850272"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How to Cite CRYSTALClear" href="cite.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CRYSTALClear
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-via-pypi">Installing via Pypi</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-from-github-source-code">Installing from GitHub Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#verification">Verification</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.adsorb">CRYSTALClear.adsorb</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.adsorb.sub_ads_indices"><code class="docutils literal notranslate"><span class="pre">sub_ads_indices()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.calculate">CRYSTALClear.calculate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.calculate.cry_ads_energy"><code class="docutils literal notranslate"><span class="pre">cry_ads_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.calculate.cry_shrink"><code class="docutils literal notranslate"><span class="pre">cry_shrink()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.convert">CRYSTALClear.convert</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_ase2gui"><code class="docutils literal notranslate"><span class="pre">cry_ase2gui()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_bands2pmg"><code class="docutils literal notranslate"><span class="pre">cry_bands2pmg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_gui2ase"><code class="docutils literal notranslate"><span class="pre">cry_gui2ase()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_gui2cif"><code class="docutils literal notranslate"><span class="pre">cry_gui2cif()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_gui2pmg"><code class="docutils literal notranslate"><span class="pre">cry_gui2pmg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_gui2xyz"><code class="docutils literal notranslate"><span class="pre">cry_gui2xyz()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_out2ase"><code class="docutils literal notranslate"><span class="pre">cry_out2ase()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_out2cif"><code class="docutils literal notranslate"><span class="pre">cry_out2cif()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_out2pmg"><code class="docutils literal notranslate"><span class="pre">cry_out2pmg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_out2xyz"><code class="docutils literal notranslate"><span class="pre">cry_out2xyz()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.convert.cry_pmg2gui"><code class="docutils literal notranslate"><span class="pre">cry_pmg2gui()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.crystal_io">CRYSTALClear.crystal_io</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_input"><code class="docutils literal notranslate"><span class="pre">Crystal_input</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_output"><code class="docutils literal notranslate"><span class="pre">Crystal_output</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.crystal_io.Properties_input"><code class="docutils literal notranslate"><span class="pre">Properties_input</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.crystal_io.Properties_output"><code class="docutils literal notranslate"><span class="pre">Properties_output</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_gui"><code class="docutils literal notranslate"><span class="pre">Crystal_gui</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_density"><code class="docutils literal notranslate"><span class="pre">Crystal_density</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.crystal_io.cry_combine_density"><code class="docutils literal notranslate"><span class="pre">cry_combine_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.crystal_io.write_cry_density"><code class="docutils literal notranslate"><span class="pre">write_cry_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.crystal_io.External_unit"><code class="docutils literal notranslate"><span class="pre">External_unit</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.execute">CRYSTALClear.execute</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.execute.set_runcry_path"><code class="docutils literal notranslate"><span class="pre">set_runcry_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.execute.set_runprop_path"><code class="docutils literal notranslate"><span class="pre">set_runprop_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.execute.runcry"><code class="docutils literal notranslate"><span class="pre">runcry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.execute.runprop"><code class="docutils literal notranslate"><span class="pre">runprop()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.flatmaps">CRYSTALClear.flatmaps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.flatmaps.ElectricChargeDensity"><code class="docutils literal notranslate"><span class="pre">ElectricChargeDensity</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.flatmaps.OrbitalMagnetizationField"><code class="docutils literal notranslate"><span class="pre">OrbitalMagnetizationField</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.flatmaps.ChargeCurrentField"><code class="docutils literal notranslate"><span class="pre">ChargeCurrentField</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.flatmaps.SpinCurrentField"><code class="docutils literal notranslate"><span class="pre">SpinCurrentField</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.geometry">CRYSTALClear.geometry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.geometry.rotate_lattice"><code class="docutils literal notranslate"><span class="pre">rotate_lattice()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.geometry.refine_geometry"><code class="docutils literal notranslate"><span class="pre">refine_geometry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.geometry.get_pcel"><code class="docutils literal notranslate"><span class="pre">get_pcel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.geometry.get_scel"><code class="docutils literal notranslate"><span class="pre">get_scel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.geometry.get_sg_symmops"><code class="docutils literal notranslate"><span class="pre">get_sg_symmops()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.geometry.Miller_norm"><code class="docutils literal notranslate"><span class="pre">Miller_norm()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.plot">CRYSTALClear.plot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_dens_ECHG"><code class="docutils literal notranslate"><span class="pre">plot_dens_ECHG()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_vecfield2D_m"><code class="docutils literal notranslate"><span class="pre">plot_vecfield2D_m()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_vecfield2D_j"><code class="docutils literal notranslate"><span class="pre">plot_vecfield2D_j()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_vecfield2D_J"><code class="docutils literal notranslate"><span class="pre">plot_vecfield2D_J()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_phonon_band"><code class="docutils literal notranslate"><span class="pre">plot_phonon_band()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_electron_band"><code class="docutils literal notranslate"><span class="pre">plot_electron_band()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_electron_dos"><code class="docutils literal notranslate"><span class="pre">plot_electron_dos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_phonon_dos"><code class="docutils literal notranslate"><span class="pre">plot_phonon_dos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_electron_banddos"><code class="docutils literal notranslate"><span class="pre">plot_electron_banddos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_phonon_banddos"><code class="docutils literal notranslate"><span class="pre">plot_phonon_banddos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_contour"><code class="docutils literal notranslate"><span class="pre">plot_cry_contour()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_contour_differences"><code class="docutils literal notranslate"><span class="pre">plot_cry_contour_differences()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_xrd"><code class="docutils literal notranslate"><span class="pre">plot_cry_xrd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_rholine"><code class="docutils literal notranslate"><span class="pre">plot_cry_rholine()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_lapl_profile"><code class="docutils literal notranslate"><span class="pre">plot_cry_lapl_profile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_density_profile"><code class="docutils literal notranslate"><span class="pre">plot_cry_density_profile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_seebeck_potential"><code class="docutils literal notranslate"><span class="pre">plot_cry_seebeck_potential()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_seebeck_carrier"><code class="docutils literal notranslate"><span class="pre">plot_cry_seebeck_carrier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_multiseebeck"><code class="docutils literal notranslate"><span class="pre">plot_cry_multiseebeck()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_sigma_potential"><code class="docutils literal notranslate"><span class="pre">plot_cry_sigma_potential()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_sigma_carrier"><code class="docutils literal notranslate"><span class="pre">plot_cry_sigma_carrier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_multisigma"><code class="docutils literal notranslate"><span class="pre">plot_cry_multisigma()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_powerfactor_potential"><code class="docutils literal notranslate"><span class="pre">plot_cry_powerfactor_potential()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_powerfactor_carrier"><code class="docutils literal notranslate"><span class="pre">plot_cry_powerfactor_carrier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_zt"><code class="docutils literal notranslate"><span class="pre">plot_cry_zt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_young"><code class="docutils literal notranslate"><span class="pre">plot_cry_young()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_comp"><code class="docutils literal notranslate"><span class="pre">plot_cry_comp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_shear"><code class="docutils literal notranslate"><span class="pre">plot_cry_shear()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_poisson"><code class="docutils literal notranslate"><span class="pre">plot_cry_poisson()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_ela"><code class="docutils literal notranslate"><span class="pre">plot_cry_ela()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_irspec"><code class="docutils literal notranslate"><span class="pre">plot_cry_irspec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_ramspec"><code class="docutils literal notranslate"><span class="pre">plot_cry_ramspec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_spec"><code class="docutils literal notranslate"><span class="pre">plot_cry_spec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_spec_multi"><code class="docutils literal notranslate"><span class="pre">plot_cry_spec_multi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.plot.plot_cry_anscan"><code class="docutils literal notranslate"><span class="pre">plot_cry_anscan()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.thermodynamics">CRYSTALClear.thermodynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.thermodynamics.Mode"><code class="docutils literal notranslate"><span class="pre">Mode</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.thermodynamics.Harmonic"><code class="docutils literal notranslate"><span class="pre">Harmonic</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic"><code class="docutils literal notranslate"><span class="pre">Quasi_harmonic</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.thermodynamics.Phonopy"><code class="docutils literal notranslate"><span class="pre">Phonopy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.thermodynamics.Output"><code class="docutils literal notranslate"><span class="pre">Output</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.unit_test">CRYSTALClear.unit_test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.unit_test.crystal_input_test"><code class="docutils literal notranslate"><span class="pre">crystal_input_test()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.unit_test.crystal_output_test"><code class="docutils literal notranslate"><span class="pre">crystal_output_test()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.unit_test.convert_test"><code class="docutils literal notranslate"><span class="pre">convert_test()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.unit_test.test_all"><code class="docutils literal notranslate"><span class="pre">test_all()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-CRYSTALClear.units">CRYSTALClear.units</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.H_to_eV"><code class="docutils literal notranslate"><span class="pre">H_to_eV()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.eV_to_H"><code class="docutils literal notranslate"><span class="pre">eV_to_H()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.H_to_kjmol"><code class="docutils literal notranslate"><span class="pre">H_to_kjmol()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.kjmol_to_H"><code class="docutils literal notranslate"><span class="pre">kjmol_to_H()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.au_to_angstrom"><code class="docutils literal notranslate"><span class="pre">au_to_angstrom()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.angstrom_to_au"><code class="docutils literal notranslate"><span class="pre">angstrom_to_au()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.cm_to_thz"><code class="docutils literal notranslate"><span class="pre">cm_to_thz()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.thz_to_cm"><code class="docutils literal notranslate"><span class="pre">thz_to_cm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.hartree_to_thz"><code class="docutils literal notranslate"><span class="pre">hartree_to_thz()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.thz_to_hartree"><code class="docutils literal notranslate"><span class="pre">thz_to_hartree()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.amu_to_me"><code class="docutils literal notranslate"><span class="pre">amu_to_me()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#CRYSTALClear.units.me_to_amu"><code class="docutils literal notranslate"><span class="pre">me_to_amu()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cite.html">How to Cite CRYSTALClear</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cite.html#reference">Reference</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CRYSTALClear</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">CRYSTALClear package</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/crystaldevs/CRYSTALClear/blob/main/docs_src/CRYSTALClear.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><span class="math notranslate nohighlight">\(\newcommand{\AA}{\text{Å}}\)</span></p>
<section id="crystalclear-package">
<h1>CRYSTALClear package<a class="headerlink" href="#crystalclear-package" title="Link to this heading"></a></h1>
<section id="module-CRYSTALClear.adsorb">
<span id="crystalclear-adsorb"></span><h2>CRYSTALClear.adsorb<a class="headerlink" href="#module-CRYSTALClear.adsorb" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.adsorb.sub_ads_indices">
<span class="sig-name descname"><span class="pre">sub_ads_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.adsorb.sub_ads_indices" title="Link to this definition"></a></dt>
<dd><p>Identify the indices of substrate and adsorbate atoms in the given structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>pymatgen.core.structure.Structure</em>) – The input structure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dict</strong> – A dictionary containing the indices of adsorbate and substrate atoms.
The dictionary has two keys:
- ‘adsorbate’: A list of indices corresponding to the adsorbate atoms.
- ‘substrate’: A list of indices corresponding to the substrate atoms.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-CRYSTALClear.calculate">
<span id="crystalclear-calculate"></span><h2>CRYSTALClear.calculate<a class="headerlink" href="#module-CRYSTALClear.calculate" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.calculate.cry_ads_energy">
<span class="sig-name descname"><span class="pre">cry_ads_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e_full_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_substrate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_adsorbate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.calculate.cry_ads_energy" title="Link to this definition"></a></dt>
<dd><p>Calculate the adsorption energy of a system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e_full_system</strong> (<em>float</em>) – Total energy of the full system.</p></li>
<li><p><strong>e_substrate</strong> (<em>float</em>) – Energy of the substrate.</p></li>
<li><p><strong>e_adsorbate</strong> (<em>float</em>) – Energy of the adsorbate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>float</strong> – Adsorption energy calculated as the difference between the
total energy of the full system and the sum of the energies
of the substrate and adsorbate.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.calculate.cry_shrink">
<span class="sig-name descname"><span class="pre">cry_shrink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.calculate.cry_shrink" title="Link to this definition"></a></dt>
<dd><p>Determine the number of unit cells needed to achieve a desired spacing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>pymatgen.core.structure.Structure</em>) – The input structure.</p></li>
<li><p><strong>spacing</strong> (<em>float</em>) – The desired spacing between unit cells. Default is 0.2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>int</strong> – The number of unit cells (rounded up) needed to achieve the desired spacing.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-CRYSTALClear.convert">
<span id="crystalclear-convert"></span><h2>CRYSTALClear.convert<a class="headerlink" href="#module-CRYSTALClear.convert" title="Link to this heading"></a></h2>
<p>Functions that do conversion between data / file formats</p>
<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_ase2gui">
<span class="sig-name descname"><span class="pre">cry_ase2gui</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gui_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_ase2gui" title="Link to this definition"></a></dt>
<dd><p>Transform an ASE Structure object into a Pymatgen structure object and then
a CRYSTAL structure (gui) object. Vacuum layer is set to 500 Angstrom
as the default of CRYSTAL for low symmstry systems</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>ASE Structure</em>) – ASE Structure object.</p></li>
<li><p><strong>gui_file</strong> (<em>str</em>) – CRYSTAL gui / fort.34 file.</p></li>
<li><p><strong>vacuum</strong> (<em>float</em>) – Vacuum distance. Unit: Angstrom. If none, set the
length of non-periodic direction to 500 Angstrom. Low dimensional systems only.</p></li>
<li><p><strong>symmetry</strong> (<em>bool</em>) – Perform symmetry analysis.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_bands2pmg">
<span class="sig-name descname"><span class="pre">cry_bands2pmg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_bands2pmg" title="Link to this definition"></a></dt>
<dd><p>Transform a CRYSTAL bands object into a Pymatgen bands object. No
projection is available for now.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>band</strong> (<em>str</em><em>|</em><em>Band</em>) – CRYSTAL fort.25 or BAND.DAT file or CRYSTALClear
Band object</p></li>
<li><p><strong>output</strong> (<em>str</em>) – CRYSTAL properties output file</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – K point labels to display in the band structure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>BandStructureSymmLine</strong> – Pymatgen band structure object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_gui2ase">
<span class="sig-name descname"><span class="pre">cry_gui2ase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gui</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_gui2ase" title="Link to this definition"></a></dt>
<dd><p>Transform a CRYSTAL structure (gui) file into an ASE atoms object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gui</strong> (<em>str</em><em>|</em><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_gui" title="CRYSTALClear.crystal_io.Crystal_gui"><em>Crystal_gui</em></a>) – CRYSTAL gui / fort.34 file or CRYSTALClear gui object</p></li>
<li><p><strong>vacuum</strong> (<em>float</em>) – Vacuum distance. Unit: Angstrom. If none, set the
<code class="docutils literal notranslate"><span class="pre">pbc</span></code> attribute of ASE atoms object. Low dimensional systems only.</p></li>
<li><p><strong>**kwargs</strong> – Passed to ASE Atoms constructor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Atoms</strong> – ASE atoms object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_gui2cif">
<span class="sig-name descname"><span class="pre">cry_gui2cif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gui</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cif_file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_gui2cif" title="Link to this definition"></a></dt>
<dd><p>Read a CRYSTAL structure (gui) file and save a cif file. The <a class="reference external" href="https://pymatgen.org/pymatgen.io.html#pymatgen.io.cif.CifWriter">CifWriter</a>
object of Pymatgen is called. By default, <code class="docutils literal notranslate"><span class="pre">symprec</span> <span class="pre">=</span> <span class="pre">0.01</span></code> is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gui</strong> (<em>str</em><em>|</em><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_gui" title="CRYSTALClear.crystal_io.Crystal_gui"><em>Crystal_gui</em></a>) – CRYSTAL gui / fort.34 file or CRYSTALClear gui object</p></li>
<li><p><strong>cif_file_name</strong> (<em>str</em>) – Name (including path) of the cif file to be saved</p></li>
<li><p><strong>vacuum</strong> (<em>float</em>) – Vacuum distance. Unit: Angstrom. If none, set the
<code class="docutils literal notranslate"><span class="pre">pbc</span></code> attribute of Pymatgen atoms object. Low dimensional systems only.</p></li>
<li><p><strong>**kwargs</strong> – Passed to Pymatgen CifWriter.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_gui2pmg">
<span class="sig-name descname"><span class="pre">cry_gui2pmg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gui</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecule</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_gui2pmg" title="Link to this definition"></a></dt>
<dd><p>Transform a CRYSTAL structure (gui) object into a Pymatgen Structure object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gui</strong> (<em>str</em><em>|</em><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_gui" title="CRYSTALClear.crystal_io.Crystal_gui"><em>Crystal_gui</em></a>) – CRYSTAL gui / fort.34 file or CRYSTALClear gui object</p></li>
<li><p><strong>vacuum</strong> (<em>float</em>) – Vacuum distance. Unit: Angstrom. If none, set the
<code class="docutils literal notranslate"><span class="pre">pbc</span></code> attribute of Pymatgen object. Low dimensional systems only.</p></li>
<li><p><strong>molecule</strong> (<em>bool</em>) – Generate a Molecule Pymatgen object for 0D structures.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Structure or Molecule</strong> – Pymatgen Structure or Molecule object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_gui2xyz">
<span class="sig-name descname"><span class="pre">cry_gui2xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gui</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_file_name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_gui2xyz" title="Link to this definition"></a></dt>
<dd><p>Transform a CRYSTAL structure (gui) file into an XYZ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz_file_name</strong> (<em>str</em>) – Name of the XYZ file to be saved.</p></li>
<li><p><strong>gui</strong> (<em>str</em>) – CRYSTAL gui / fort.34 file.</p></li>
<li><p><strong>**kwargs</strong> – Passed to Pymatgen XYZ object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_out2ase">
<span class="sig-name descname"><span class="pre">cry_out2ase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_out2ase" title="Link to this definition"></a></dt>
<dd><p>Transform a CRYSTAL output object into an ASE atoms object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> (<em>str</em><em>|</em><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_output" title="CRYSTALClear.crystal_io.Crystal_output"><em>Crystal_output</em></a>) – Crystal output file or Crystal_output object</p></li>
<li><p><strong>vacuum</strong> (<em>float</em>) – Vacuum distance. Unit: Angstrom. If none, set the
<code class="docutils literal notranslate"><span class="pre">pbc</span></code> attribute of ASE atoms object. Low dimensional systems only.</p></li>
<li><p><strong>initial</strong> (<em>bool</em>) – Read the last geometry of the output file.</p></li>
<li><p><strong>**kwargs</strong> – Passed to ASE Atoms constructor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Atoms</strong> – ASE atoms object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_out2cif">
<span class="sig-name descname"><span class="pre">cry_out2cif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cif_file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_out2cif" title="Link to this definition"></a></dt>
<dd><p>Read geometry from a CRYSTAL output file and save it as a CIF file. The
<a class="reference external" href="https://pymatgen.org/pymatgen.io.html#pymatgen.io.cif.CifWriter">CifWriter</a>
object of Pymatgen is called. By default, <code class="docutils literal notranslate"><span class="pre">symprec</span> <span class="pre">=</span> <span class="pre">0.01</span></code> is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> (<em>str</em><em>|</em><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_output" title="CRYSTALClear.crystal_io.Crystal_output"><em>Crystal_output</em></a>) – Crystal output file or Crystal_output object</p></li>
<li><p><strong>cif_file_name</strong> (<em>str</em>) – Name (including path) of the CIF file to be saved.</p></li>
<li><p><strong>vacuum</strong> (<em>float</em>) – Vacuum distance. Unit: Angstrom. If none, set the
<code class="docutils literal notranslate"><span class="pre">pbc</span></code> attribute of Pymatgen atoms object. Low dimensional systems only.</p></li>
<li><p><strong>initial</strong> (<em>bool</em>) – Read the last geometry of the output file.</p></li>
<li><p><strong>**kwargs</strong> – Passed to Pymatgen CifWriter.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_out2pmg">
<span class="sig-name descname"><span class="pre">cry_out2pmg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecule</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_out2pmg" title="Link to this definition"></a></dt>
<dd><p>Read geometry from a CRYSTAL output file and save it as a pymatgen structure
object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> (<em>str</em><em>|</em><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_output" title="CRYSTALClear.crystal_io.Crystal_output"><em>Crystal_output</em></a>) – Crystal output file or Crystal_output object</p></li>
<li><p><strong>vacuum</strong> (<em>float</em>) – Vacuum distance. Unit: Angstrom. If none, set the
<code class="docutils literal notranslate"><span class="pre">pbc</span></code> attribute of Pymatgen object. Low dimensional systems only.</p></li>
<li><p><strong>initial</strong> (<em>bool</em>) – Read the last geometry of the output file.</p></li>
<li><p><strong>molecule</strong> (<em>bool</em>) – Generate a Molecule Pymatgen object for 0D structures.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Structure</strong> – Pymatgen Structure object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_out2xyz">
<span class="sig-name descname"><span class="pre">cry_out2xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_out2xyz" title="Link to this definition"></a></dt>
<dd><p>Read geometry from a CRYSTAL output file and save it as an XYZ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> (<em>str</em><em>|</em><a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_output" title="CRYSTALClear.crystal_io.Crystal_output"><em>Crystal_output</em></a>) – Crystal output file or Crystal_output object</p></li>
<li><p><strong>xyz_file_name</strong> (<em>str</em>) – Name (including path) of the XYZ file to be saved.</p></li>
<li><p><strong>initial</strong> (<em>bool</em>) – Read the last geometry of the output file.</p></li>
<li><p><strong>**kwargs</strong> – Passed to Pymatgen XYZ object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.convert.cry_pmg2gui">
<span class="sig-name descname"><span class="pre">cry_pmg2gui</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gui_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zconv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.convert.cry_pmg2gui" title="Link to this definition"></a></dt>
<dd><p>Save a pymatgen Structure object into a CRYSTAL gui file. Vacuum layer is
set to 500 Angstrom as the default of CRYSTAL for low symmstry systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em><em> | </em><em>Molecule</em>) – Pymatgen Structure / Molecule object.</p></li>
<li><p><strong>gui_file</strong> (<em>str</em>) – CRYSTAL gui / fort.34 file.</p></li>
<li><p><strong>pbc</strong> (<em>list</em>) – 1*3 boolian list. Implements periodicity along x, y and z
directions. If none, the code will read it from input structure.</p></li>
<li><p><strong>vacuum</strong> (<em>float</em>) – Vacuum distance. Unit: Angstrom. If none, set the
length of non-periodic direction to 500 Angstrom. Low dimensional
systems only.</p></li>
<li><p><strong>symmetry</strong> (<em>bool</em>) – Do symmetry analysis.</p></li>
<li><p><strong>zconv</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – 1st element: The <strong>index</strong> of atom;
2nd element: The new conventional atomic number.</p></li>
<li><p><strong>**kwargs</strong> – Passed to Pymatgen SpacegroupAnalyzer object. Valid only
if <code class="docutils literal notranslate"><span class="pre">symmetry=True</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-CRYSTALClear.crystal_io">
<span id="crystalclear-crystal-io"></span><h2>CRYSTALClear.crystal_io<a class="headerlink" href="#module-CRYSTALClear.crystal_io" title="Link to this heading"></a></h2>
<p>Objects of input / output files of CRYSTAL. Methods to edit or substract data
from corresponding files are provided.</p>
<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_input">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Crystal_input</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_input" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="CRYSTALClear.base.html#CRYSTALClear.base.crysd12.Crystal_inputBASE" title="CRYSTALClear.base.crysd12.Crystal_inputBASE"><code class="xref py py-class docutils literal notranslate"><span class="pre">Crystal_inputBASE</span></code></a></p>
<p>Crystal input object inherited from the <span class="xref std std-ref">Crystal_inputBASE</span>
object. For the basic set-ups of keywords, please refer to manuals there.</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_input.geom_from_cif">
<span class="sig-name descname"><span class="pre">geom_from_cif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zconv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyword</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EXTERNAL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[True,</span> <span class="pre">True,</span> <span class="pre">True]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gui_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fort.34'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_input.geom_from_cif" title="Link to this definition"></a></dt>
<dd><p>Read geometry from cif file and put infomation to geom block, either as
‘EXTERNAL’ or ‘CRYSTAL’. CIF files with a single geometry only.</p>
<p>CIF with Symmetry is required.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CIF files should have the ‘.cif’ extension.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – CIF file.</p></li>
<li><p><strong>keyword</strong> (<em>str</em>) – ‘EXTERNAL’ or ‘CRYSTAL’.</p></li>
<li><p><strong>zconv</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – 1st element: The <strong>index</strong> of atom;
2nd element: The new conventional atomic number. Atoms of the
irreducible unit is required.</p></li>
<li><p><strong>pbc</strong> (<em>list</em><em>[</em><em>bool</em><em>]</em>) – Valid only if <code class="docutils literal notranslate"><span class="pre">keyword</span> <span class="pre">=</span> <span class="pre">EXTERNAL</span></code>. Force to remove
periodic boundary conditions along x, y, z axis.</p></li>
<li><p><strong>gui_name</strong> (<em>str</em>) – Valid only if <code class="docutils literal notranslate"><span class="pre">keyword</span> <span class="pre">=</span> <span class="pre">EXTERNAL</span></code>. Gui file’s name.</p></li>
<li><p><strong>**kwargs</strong> – Passed to Pymatgen <a class="reference external" href="https://pymatgen.org/pymatgen.symmetry.html#pymatgen.symmetry.analyzer.SpacegroupAnalyzer">SpacegroupAnalyzer</a> object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_input.geom_from_pmg">
<span class="sig-name descname"><span class="pre">geom_from_pmg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zconv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyword</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EXTERNAL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gui_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fort.34'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_input.geom_from_pmg" title="Link to this definition"></a></dt>
<dd><p>Read geometry defined by PyMatGen structure object and put infomation
into geom block, either as ‘EXTERNAL’ or ‘CRYSTAL’.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">geom_from_cif</span></code> for definition of arguments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Coordinates of corresponding atoms may not consistent with the
original CIF file if ‘CRYSTAL’ is used, in which case
coordinates of another symmetry equivalent atom is used.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_input.bs_from_bse">
<span class="sig-name descname"><span class="pre">bs_from_bse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zconv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_input.bs_from_bse" title="Link to this definition"></a></dt>
<dd><p>Download basis set definitions from BSE. A wrapper of BasisSetBASE.from_bse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Basis set’s name.</p></li>
<li><p><strong>element</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>list</em><em>[</em><em>int</em><em>]</em>) – List of elements.</p></li>
<li><p><strong>zconv</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – If not none, use the conventional atomic number.
Its length must be the same as element. Its sequence must be
consistent with basis set’s</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_input.bs_from_string">
<span class="sig-name descname"><span class="pre">bs_from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'crystal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_input.bs_from_string" title="Link to this definition"></a></dt>
<dd><p>Define basis set from a string. A wrapper of BasisSetBASE.from_string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bs_str</strong> (<em>str</em>)</p></li>
<li><p><strong>fmt</strong> (<em>str</em>) – Format string. Consistent with BSE python API.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_input.bs_from_file">
<span class="sig-name descname"><span class="pre">bs_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'crystal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_input.bs_from_file" title="Link to this definition"></a></dt>
<dd><p>Define a basis set from a file. A wrapper of BasisSetBASE.from_file.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Crystal_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class reads a CRYSTAL output and generates an object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.read_cry_output">
<span class="sig-name descname"><span class="pre">read_cry_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.read_cry_output" title="Link to this definition"></a></dt>
<dd><p>Deprecated</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_dielectric_tensor">
<span class="sig-name descname"><span class="pre">get_dielectric_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_dielectric_tensor" title="Link to this definition"></a></dt>
<dd><p>Extracts the dielectric tensor from the output.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>list</strong> – Dielectric tensor values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_eigenvectors">
<span class="sig-name descname"><span class="pre">get_eigenvectors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_eigenvectors" title="Link to this definition"></a></dt>
<dd><p>Extracts eigenvectors from the output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_dimensionality">
<span class="sig-name descname"><span class="pre">get_dimensionality</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_dimensionality" title="Link to this definition"></a></dt>
<dd><p>Gets the dimensionality of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.dimensionality</strong> (<em>int</em>) – Dimensionality of the system.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_symmops">
<span class="sig-name descname"><span class="pre">get_symmops</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_symmops" title="Link to this definition"></a></dt>
<dd><p>Return the symmetry operators</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.symmops</strong> (<em>numpy.ndarray</em>) – Symmetry operators</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_geometry">
<span class="sig-name descname"><span class="pre">get_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_gui</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gui_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pymatgen'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_geometry" title="Link to this definition"></a></dt>
<dd><p>Get the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial</strong> (<em>bool</em>) – Read the initial or last gemetry. Useful in
case of geometry optimization.</p></li>
<li><p><strong>write_gui</strong> (<em>bool</em>) – If True, write .gui file</p></li>
<li><p><strong>gui_name</strong> (<em>str</em>) – Valid only if <code class="docutils literal notranslate"><span class="pre">write_gui</span> <span class="pre">=</span> <span class="pre">True</span></code>. Gui file
is named as ‘gui_name’. If None, use ‘basename.gui’. The
basename is the same as output file.</p></li>
<li><p><strong>symmetry</strong> (<em>str</em>) – Valid only if <code class="docutils literal notranslate"><span class="pre">write_gui</span> <span class="pre">=</span> <span class="pre">True</span></code>. ‘pymatgen’
to use symmetry info from a pymatgen SpacegroupAnalyzer;
‘initial’ to use symmstry information on output file. If
None, no symmstry. Otherwise it is taken from the existing
gui file.</p></li>
<li><p><strong>**kwargs</strong> – Valid only if <code class="docutils literal notranslate"><span class="pre">write_gui</span> <span class="pre">=</span> <span class="pre">True</span></code> and
<code class="docutils literal notranslate"><span class="pre">symmetry</span> <span class="pre">=</span> <span class="pre">'pymatgen'</span></code>.  Passed to Pymatgen
SpacegroupAnalyzer object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.geometry</strong> (<em>Structure | Molecule</em>) – A pymatgen Structure or
molecule object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_last_geom">
<span class="sig-name descname"><span class="pre">get_last_geom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">write_gui_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pymatgen'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_last_geom" title="Link to this definition"></a></dt>
<dd><p>Return the last optimised geometry.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_lattice">
<span class="sig-name descname"><span class="pre">get_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_lattice" title="Link to this definition"></a></dt>
<dd><p>Returns the lattice of the system. Unit: Angstrom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>initial</strong> (<em>bool</em>) – Read the initial or last lattice. Useful in
case of geometry optimization.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.lattice</strong> (<em>np.ndarray</em>) – Lattice of the system.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_reciprocal_lattice">
<span class="sig-name descname"><span class="pre">get_reciprocal_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_reciprocal_lattice" title="Link to this definition"></a></dt>
<dd><p>Returns the reciprocal lattice of the system. Unit: Angstrom^-1.
Reciprocal lattice is consistent with CRYSTAL: 2pi is added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>initial</strong> (<em>bool</em>) – Read the initial or last lattice. Useful in
case of geometry optimization.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.reciprocal_lattice</strong> (<em>np.ndarray</em>) – Lattice of the system.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.sg_number">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sg_number</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.sg_number" title="Link to this definition"></a></dt>
<dd><p>CRYSTAL 0~3D space group number. Before geometry editing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.sg_symbol">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sg_symbol</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.sg_symbol" title="Link to this definition"></a></dt>
<dd><p>CRYSTAL 0~3D 0~3D space group symbol. Before geometry editing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.n_atoms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_atoms</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.n_atoms" title="Link to this definition"></a></dt>
<dd><p>Number of atoms. After geometry editing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.atom_symbols">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_symbols</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.atom_symbols" title="Link to this definition"></a></dt>
<dd><p>Atom symbols. After geometry editing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.atom_numbers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_numbers</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.atom_numbers" title="Link to this definition"></a></dt>
<dd><p>Conventional atom numbers. After geometry editing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.atom_positions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_positions</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.atom_positions" title="Link to this definition"></a></dt>
<dd><p>Composite fractional / Cartesian atomic coordinates. Consistent
with CRYSTAL definitions. 3D: Fractional; 2D: Frac, Frac, Cart; 1D
Frac, Cart, Cart; 0D: Cart, Cart, Cart. After geometry editing
(before optimization).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.atom_positions_cart">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_positions_cart</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.atom_positions_cart" title="Link to this definition"></a></dt>
<dd><p>Cartesian atomic coordinates. After geometry editing (before optimization).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.atom_positions_frac">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_positions_frac</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.atom_positions_frac" title="Link to this definition"></a></dt>
<dd><p>Fractional atomic coordinates. After geometry editing (before optimization).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_trans_matrix">
<span class="sig-name descname"><span class="pre">get_trans_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_trans_matrix" title="Link to this definition"></a></dt>
<dd><p>Get cell transformation matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.trans_matrix</strong> (<em>np.ndarray</em>) – 3*3 array of supercell
expansion matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_primitive_geometry">
<span class="sig-name descname"><span class="pre">get_primitive_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_gui</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gui_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pymatgen'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_primitive_geometry" title="Link to this definition"></a></dt>
<dd><p>Get the primitive geometry, reduced by cell transformation matrix
inversed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is not the standard ‘primitive cell’. This method returns
geometry before supercell expansion keywords such as ‘SUPERCEL’
or ‘SCELPHONO’.</p>
<p>Conventional atomic numbers are not available.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial</strong> (<em>bool</em>) – Read the initial or last geometry. Useful in
case of geometry optimization.</p></li>
<li><p><strong>write_gui</strong> (<em>bool</em>) – If True, write .gui file</p></li>
<li><p><strong>gui_name</strong> (<em>str</em>) – Valid only if <code class="docutils literal notranslate"><span class="pre">write_gui</span> <span class="pre">=</span> <span class="pre">True</span></code>. Gui file
is named as ‘gui_name’. If None, use ‘basename.gui’. The
basename is the same as output file.</p></li>
<li><p><strong>symmetry</strong> (<em>str</em>) – Valid only if <code class="docutils literal notranslate"><span class="pre">write_gui</span> <span class="pre">=</span> <span class="pre">True</span></code>. ‘pymatgen’
to use symmetry info from a pymatgen SpacegroupAnalyzer;
‘initial’ to use symmstry information on output file. If
None, no symmstry. Otherwise it is taken from the existing
gui file.</p></li>
<li><p><strong>**kwargs</strong> – Valid only if <code class="docutils literal notranslate"><span class="pre">write_gui</span> <span class="pre">=</span> <span class="pre">True</span></code> and
<code class="docutils literal notranslate"><span class="pre">symmetry</span> <span class="pre">=</span> <span class="pre">'pymatgen'</span></code>.  Passed to Pymatgen
SpacegroupAnalyzer object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.primitive_geometry</strong> (<em>Structure | Molecule</em>) – A pymatgen
Structure or molecule object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_primitive_lattice">
<span class="sig-name descname"><span class="pre">get_primitive_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_primitive_lattice" title="Link to this definition"></a></dt>
<dd><p>Returns the primitive lattice of the system reduced by cell
transformation matrix inverse. Unit: Angstrom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>initial</strong> (<em>bool</em>) – Read the initial or last lattice. Useful in
case of geometry optimization.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.primitive_lattice</strong> (<em>np.ndarray</em>) – Lattice of the system.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_primitive_reciprocal_lattice">
<span class="sig-name descname"><span class="pre">get_primitive_reciprocal_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_primitive_reciprocal_lattice" title="Link to this definition"></a></dt>
<dd><p>Returns the primitive reciprocal lattice of the system before
expansion by cell transformation matrix inverse. Unit: Angstrom^-1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>initial</strong> (<em>bool</em>) – Read the initial or last lattice. Useful in
case of geometry optimization.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.primitive_reciprocal_lattice</strong> (<em>np.ndarray</em>) – Lattice of the system.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_config_analysis">
<span class="sig-name descname"><span class="pre">get_config_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_multiplicity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_config_analysis" title="Link to this definition"></a></dt>
<dd><p>Return the configuration analysis for solid solutions (CONFCON keyword in input)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_multiplicity</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return multiplicity information. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>list or str</strong> – Configuration analysis if available, or a warning message</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_convergence">
<span class="sig-name descname"><span class="pre">get_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_convergence" title="Link to this definition"></a></dt>
<dd><p>The upper level of <code class="docutils literal notranslate"><span class="pre">get_scf_convergence</span></code> and <code class="docutils literal notranslate"><span class="pre">get_opt_convergence</span></code>.
For analysing the geometry and energy convergence.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It might not work well with SCF / OPT cycles of multiple systems
such as PREOPTGEOM + EOS calculations</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>history</strong> (<em>bool</em>) – If true, the convergence history of optimisation
(energy,gradient, displacement) / SCF is returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self</strong> (<em>Crystal_output</em>) – New attributes listed below</p></li>
<li><p><strong>self.final_energy</strong> (<em>float</em>) – eV</p></li>
</ul>
</dd>
</dl>
<p>For other attributes, see <code class="docutils literal notranslate"><span class="pre">get_scf_convergence</span></code> and
<code class="docutils literal notranslate"><span class="pre">get_opt_convergence</span></code> methods on the same page.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_scf_convergence">
<span class="sig-name descname"><span class="pre">get_scf_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_cycles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_scf_convergence" title="Link to this definition"></a></dt>
<dd><p>Returns the scf convergence energy and energy difference. A wrapper of
<code class="docutils literal notranslate"><span class="pre">CRYSTALClear.base.SCFBASE.read_convergence</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>all_cycles</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return all SCF steps for a geometry
opt. The ‘ONELOG’ CRYSTAL keyword is needed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self</strong> (<em>Crystal_output</em>) – New attributes listed below</p></li>
<li><p><strong>self.scf_cycles</strong> (<em>int | array</em>) – Number of cycles. Array if
<code class="docutils literal notranslate"><span class="pre">all_cycles=True</span></code>.</p></li>
<li><p><strong>self.scf_status</strong> (<em>str | list</em>) – ‘terminated’, ‘converged’,
‘too many cycles’ and ‘unknown’. List if <code class="docutils literal notranslate"><span class="pre">all_cycles=True</span></code>.</p></li>
<li><p><strong>self.scf_energy</strong> (<em>array</em>) – SCF energy convergence. Unit: eV</p></li>
<li><p><strong>self.scf_deltae</strong> (<em>array</em>) – Energy difference. Unit: eV</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_fermi_energy">
<span class="sig-name descname"><span class="pre">get_fermi_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_fermi_energy" title="Link to this definition"></a></dt>
<dd><p>Returns the system Fermi energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>history</strong> (<em>bool</em>) – Whether to read the convergence history of Fermi energy.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.fermi_energy</strong> (<em>float | array</em>) – Fermi energy of the system. For
spin-polarized insulating systems, <code class="docutils literal notranslate"><span class="pre">self.fermi_energy</span></code> would
be either a 2*1 array (<code class="docutils literal notranslate"><span class="pre">history=False</span></code>) or a nCYC*2 array
(<code class="docutils literal notranslate"><span class="pre">history=True</span></code>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_band_gap">
<span class="sig-name descname"><span class="pre">get_band_gap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_band_gap" title="Link to this definition"></a></dt>
<dd><p>Returns the system band gap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>history</strong> (<em>bool</em>) – Whether to read the convergence history of band gap.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.band_gap</strong> (<em>float | array</em>) – Band gap of the system. For
spin-polarized systems, <code class="docutils literal notranslate"><span class="pre">self.band_gap</span></code> would be either a
2*1 array (<code class="docutils literal notranslate"><span class="pre">history=False</span></code>) or a nCYC*2 array
(<code class="docutils literal notranslate"><span class="pre">history=True</span></code>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_mulliken_charges">
<span class="sig-name descname"><span class="pre">get_mulliken_charges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_mulliken_charges" title="Link to this definition"></a></dt>
<dd><p>Return the atomic Mulliken charges (PPAN keyword in input).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.mulliken_charges</strong> (<em>array</em>) – natom*1 for non spin-polarised systems.
natom*3 for spin-polarised systems. [total, <span class="math notranslate nohighlight">\(lpha\)</span>, <span class="math notranslate nohighlight">\(eta\)</span>].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_final_energy">
<span class="sig-name descname"><span class="pre">get_final_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_final_energy" title="Link to this definition"></a></dt>
<dd><p>Get the final energy of the system. A wrapper of <code class="docutils literal notranslate"><span class="pre">self.get_convergence</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.final_energy</strong> (<em>float</em>) – The final energy of the system.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_num_cycles">
<span class="sig-name descname"><span class="pre">get_num_cycles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_num_cycles" title="Link to this definition"></a></dt>
<dd><p>Deprecated</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.scf_cycles</strong> (<em>int</em>) – Number of SCF cycles.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_opt_convergence_energy">
<span class="sig-name descname"><span class="pre">get_opt_convergence_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_opt_convergence_energy" title="Link to this definition"></a></dt>
<dd><p>Deprecated. Returns the energy for each opt step.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.opt_energy</strong> (<em>array</em>) – Energy for each optimization step.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_opt_convergence">
<span class="sig-name descname"><span class="pre">get_opt_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primitive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_gui</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gui_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pymatgen'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_opt_convergence" title="Link to this definition"></a></dt>
<dd><p>Returns optimisation convergence. A wrapper of
<code class="docutils literal notranslate"><span class="pre">CRYSTALClear.base.OptBASE.read_convergence</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primitive</strong> (<em>bool</em>) – Restore the primitive cell (multiply by the
cell transform matrix inversed)</p></li>
<li><p><strong>scf_history</strong> (<em>bool</em>) – Read SCF history of each optimisation step.
Keyword ‘ONELOG’ is needed. Please refer to
<code class="docutils literal notranslate"><span class="pre">self.get_scf_convergence(all_cycles=True)</span></code> method.</p></li>
<li><p><strong>write_gui</strong> (<em>bool</em>) – If True, write .gui file of each step</p></li>
<li><p><strong>gui_name</strong> (<em>str</em>) – Valid only if <code class="docutils literal notranslate"><span class="pre">write_gui</span> <span class="pre">=</span> <span class="pre">True</span></code>. Gui file
is named as ‘gui_name-optxxx.gui’. If None, use
‘basename-optxxx.gui’. The basename is the same as output.</p></li>
<li><p><strong>symmetry</strong> (<em>str</em>) – Valid only if <code class="docutils literal notranslate"><span class="pre">write_gui</span> <span class="pre">=</span> <span class="pre">True</span></code>. ‘pymatgen’
to use symmetry info from a pymatgen SpacegroupAnalyzer;
‘initial’ to use symmstry information on output file. If
None, no symmstry. Otherwise it is taken from the existing
gui file.</p></li>
<li><p><strong>**kwargs</strong> – Valid only if <code class="docutils literal notranslate"><span class="pre">write_gui</span> <span class="pre">=</span> <span class="pre">True</span></code> and
<code class="docutils literal notranslate"><span class="pre">symmetry</span> <span class="pre">=</span> <span class="pre">'pymatgen'</span></code>.  Passed to Pymatgen
SpacegroupAnalyzer object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self</strong> (<em>Crystal_output</em>) – New attributes listed below</p></li>
<li><p><strong>self.opt_cycles</strong> (<em>int</em>) – Number of cycles.</p></li>
<li><p><strong>self.opt_status</strong> (<em>str</em>) – ‘terminated’, ‘converged’, ‘failed’ and ‘unknown’</p></li>
<li><p><strong>self.opt_energy</strong> (<em>array</em>) – Total energy convergence. Unit: eV</p></li>
<li><p><strong>self.opt_deltae</strong> (<em>array</em>) – Total energy difference. Unit: eV</p></li>
<li><p><strong>self.opt_geometry</strong> (<em>list</em>) – Pymatgen structure at each step.</p></li>
<li><p><strong>self.opt_maxgrad</strong> (<em>array</em>) – Maximum gradient convergence. Unit: Hartree/Bohr</p></li>
<li><p><strong>self.opt_rmsgrad</strong> (<em>array</em>) – RMS gradient convergence. Unit: Hartree/Bohr</p></li>
<li><p><strong>self.opt_maxdisp</strong> (<em>array</em>) – Maximum displacement convergence. Unit: Bohr</p></li>
<li><p><strong>self.opt_rmsdisp</strong> (<em>array</em>) – RMS displacement convergence. Unit: Bohr</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_forces">
<span class="sig-name descname"><span class="pre">get_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_forces" title="Link to this definition"></a></dt>
<dd><p>Read forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial</strong> (<em>bool</em>) – Return forces from the initial calculation. If
<code class="docutils literal notranslate"><span class="pre">initial=False</span></code>, return to the last forces, which is valid
only for geometry optimizations and the keyword ‘ONELOG’ is
needed in d12 file.</p></li>
<li><p><strong>grad</strong> (<em>bool</em>) – Return gradient convergence history. For optimizations
only.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self</strong> (<em>Crystal_output</em>) – New attributes listed below</p></li>
<li><p><strong>self.forces_atoms</strong> (<em>array</em>) – natom*3 array. Atomic forces. Unit: Hartree/Bohr</p></li>
<li><p><strong>self.forces_cell</strong> (<em>array</em>) – 3*3 array. Cell forces, 3D only. Unit: Hartree/Bohr</p></li>
<li><p><strong>self.opt_maxgrad</strong> (<em>array</em>) – Maximum gradient convergence. Unit: Hartree/Bohr</p></li>
<li><p><strong>self.opt_rmsgrad</strong> (<em>array</em>) – RMS gradient convergence. Unit: Hartree/Bohr</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_phonon">
<span class="sig-name descname"><span class="pre">get_phonon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">read_eigvt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rm_imaginary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rm_overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvt_amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_phonon" title="Link to this definition"></a></dt>
<dd><p>Read phonon-related properties from output file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>read_eigvt</strong> (<em>bool</em>) – Whether to read phonon eigenvectors and
normalize it to 1.</p></li>
<li><p><strong>rm_imaginary</strong> (<em>bool</em>) – Remove the modes with negative frequencies and
set all the related properties to NaN.</p></li>
<li><p><strong>rm_overlap</strong> (<em>bool</em>) – <em>For dispersion calculations</em> Remove repeated q
points and recalculate their weights.</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – <em>``rm_imaginary`` = True only</em> The threshold
of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – <em>``rm_overlap`` = True only</em> The threshold of
overlapping points, defined as the 2nd norm of the difference
of fractional q vectors</p></li>
<li><p><strong>eigvt_amplitude</strong> (<em>float</em><em> | </em><em>str</em>) – <em>``read_eigvt = True only``</em>
Amplitude of normalization, Or ‘classical’, ‘classical-rev’,
classical amplitude and revmove classical amplitude.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In QHA calculations, the ‘q point’ dimension refer to harmonic
phonons computed. In other cases it refers to points in reciprocal
space.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> (<em>Crystal_output</em>) – New attributes listed below</p></li>
<li><p><strong>self.edft</strong> (<em>array[float]</em>) – <span class="math notranslate nohighlight">\(E_{0}\)</span> Energy with empirical
correction. Unit: kJ/mol.</p></li>
<li><p><strong>self.nqpoint</strong> (<em>int</em>) – Number of q points</p></li>
<li><p><strong>self.qpoint</strong> (<em>list[list[array[float], float]]</em>) – A nqpoint*1 list of
2*1 list whose first element is a 3*1 array of fractional
coordinates and the second is its weight.</p></li>
<li><p><strong>self.nmode</strong> (<em>array[int]</em>) – Number of modes at q point. nqpoint*1
array.</p></li>
<li><p><strong>self.frequency</strong> (<em>array[float]</em>) – nqpoint*nmode array ofvibrational
frequency. Unit: THz</p></li>
<li><p><strong>self.intens</strong> (<em>array[float]</em>) – nqpoint*nmode array of harmonic
intensiy. Unit: km/mol</p></li>
<li><p><strong>self.IR</strong> (<em>array[bool]</em>) – nqpoint*nmode array of boolean values
specifying whether the mode is IR active</p></li>
<li><p><strong>self.Raman</strong> (<em>array[bool]</em>) – nqpoint*nmode array of boolean values
specifying whether the mode is Raman active</p></li>
<li><p><strong>self.eigenvector</strong> (<em>array[complex]</em>) – <em>``read_eigvt = True only``</em>
nqpoint*nmode*natom*3 array of eigenvectors. Normalized to 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_q_info">
<span class="sig-name descname"><span class="pre">get_q_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_q_info" title="Link to this definition"></a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_mode">
<span class="sig-name descname"><span class="pre">get_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_mode" title="Link to this definition"></a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_phonon_eigenvector">
<span class="sig-name descname"><span class="pre">get_phonon_eigenvector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_phonon_eigenvector" title="Link to this definition"></a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_anh_spectra">
<span class="sig-name descname"><span class="pre">get_anh_spectra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_anh_spectra" title="Link to this definition"></a></dt>
<dd><p>This method reads data from a CRYSTAL output file and processes it to
extract anharmonic (VSCF and VCI) IR and Raman spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self.IR_HO_0K</strong> (<em>array[float]</em>) – 2D numpy array containing harmonic IR frequency and intensities computed at 0 K.</p></li>
<li><p><strong>self.IR_HO_T</strong> (<em>array[float]</em>) – 2D numpy array containing harmonic IR frequency and intensities computed at temperature T.</p></li>
<li><p><strong>self.IR_VSCF_0K</strong> (<em>array[float]</em>) – 2D numpy array containing VSCF IR frequency and intensities computed at 0 K.</p></li>
<li><p><strong>self.IR_VSCF_T</strong> (<em>array[float]</em>) – 2D numpy array containing VSCF IR frequency and intensities computed at temperature T.</p></li>
<li><p><strong>self.IR_VCI_0K</strong> (<em>array[float]</em>) – 2D numpy array containing VCI IR frequency and intensities computed at 0 K.</p></li>
<li><p><strong>self.IR_VCI_T</strong> (<em>array[float]</em>) – 2D numpy array containing VCI IR frequency and intensities computed at temperature T.</p></li>
<li><p><strong>self.Ram_HO_0K_tot</strong> (<em>array[float]</em>) – 2D numpy array containing harmonic Raman frequency and intensities (total) computed at 0 K.</p></li>
<li><p><strong>self.Ram_HO_0K_per</strong> (<em>array[float]</em>) – 2D numpy array containing harmonic Raman frequency and intensities (perpendicular component ) computed at temperature 0 K.</p></li>
<li><p><strong>self.Ram_HO_0K_par</strong> (<em>array[float]</em>) – 2D numpy array containing harmonic Raman frequency and intensities (parallel component ) computed at temperature 0 K.</p></li>
<li><p><strong>self.Ram_HO_T_tot</strong> (<em>array[float]</em>) – 2D numpy array containing harmonic Raman frequency and intensities (total) computed at temperature T.</p></li>
<li><p><strong>self.Ram_HO_T_per</strong> (<em>array[float]</em>) – 2D numpy array containing harmonic Raman frequency and intensities (perpendicular component ) computed at temperature T.</p></li>
<li><p><strong>self.Ram_HO_T_par</strong> (<em>array[float]</em>) – 2D numpy array containing harmonic Raman frequency and intensities (parallel component ) computed at temperature T.</p></li>
<li><p><strong>self.Ram_VSCF_0K_tot</strong> (<em>array[float]</em>) – 2D numpy array containing VSCF Raman frequency and intensities (total) computed at 0 K. self.Ram_VSCF_0K_per (array[float]): 2D numpy array containing VSCF Raman frequency and intensities (perpendicular component) computed at 0 K.</p></li>
<li><p><strong>self.Ram_VSCF_0K_par</strong> (<em>array[float]</em>) – 2D numpy array containing VSCF Raman frequency and intensities (parallel component) computed at 0 K.</p></li>
<li><p><strong>self.Ram_VSCF_T_tot</strong> (<em>array[float]</em>) – 2D numpy array containing VSCF Raman frequency and intensities (total) computed at temperature T. self.Ram_VSCF_T_per (array[float]): 2D numpy array containing VSCF Raman frequency and intensities (perpendicular component) computed at temperature T.</p></li>
<li><p><strong>self.Ram_VSCF_T_par</strong> (<em>array[float]</em>) – 2D numpy array containing VSCF Raman frequency and intensities (parallel component) computed at temperature T.</p></li>
<li><p><strong>self.Ram_VCI_0K_tot</strong> (<em>array[float]</em>) – 2D numpy array containing VCI Raman frequency and intensities (total) computed at 0 K.</p></li>
<li><p><strong>self.Ram_VCI_0K_per</strong> (<em>array[float]</em>) – 2D numpy array containing VCI Raman frequency and intensities (perpendicular component) computed at 0 K.</p></li>
<li><p><strong>self.Ram_VCI_0K_par</strong> (<em>array[float]</em>) – 2D numpy array containing VCI Raman frequency and intensities (parallel component) computed at 0 K.</p></li>
<li><p><strong>self.Ram_VCI_T_tot</strong> (<em>array[float]</em>) – 2D numpy array containing VCI Raman frequency and intensities (total) computed at temperature T.</p></li>
<li><p><strong>self.Ram_VCI_T_per</strong> (<em>array[float]</em>) – 2D numpy array containing VCI Raman frequency and intensities (perpendicular component) computed at temperature T.</p></li>
<li><p><strong>self.Ram_VCI_T_par</strong> (<em>array[float]</em>) – 2D numpy array containing VCI Raman frequency and intensities (parallel component) computed at temperature T.</p></li>
<li><p><strong>self.Ram_HO_0K_comp_xx</strong> (<em>array[float]</em>) – 2D numpy array containing harmonic Raman frequency and intensities (xx component) computed at 0 K.</p></li>
<li><p><strong>self.Ram_HO_T_comp_xx</strong> (<em>array[float]</em>) – 2D numpy array containing harmonic Raman frequency and intensities (xx component) computed at temperature T.</p></li>
<li><p><strong>self.Ram_VSCF_0K_comp_xx</strong> (<em>array[float]</em>) – 2D numpy array containing VSCF Raman frequency and intensities (xx component) computed at 0 K.</p></li>
<li><p><strong>self.Ram_VSCF_T_comp_xx</strong> (<em>array[float]</em>) – 2D numpy array containing VSCF Raman frequency and intensities (xx component) computed at temperature T.</p></li>
<li><p><strong>self.Ram_VCI_0K_comp_xx</strong> (<em>array[float]</em>) – 2D numpy array containing VCI Raman frequency and intensities (xx component) computed at 0 K.</p></li>
<li><p><strong>self.Ram_VCI_T_comp_xx</strong> (<em>array[float]</em>) – 2D numpy array containing VCI Raman frequency and intensities (xx component) computed at temperature T.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please, note that for the sake of brevity, only the xx Raman component attributes have been listed here, but the yy, zz, xy, xz, yz components are available as well.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_anscan">
<span class="sig-name descname"><span class="pre">get_anscan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anscanwf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_anscan" title="Link to this definition"></a></dt>
<dd><p>Work in progress for ANSCAN stuff</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_output.get_elatensor">
<span class="sig-name descname"><span class="pre">get_elatensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_output.get_elatensor" title="Link to this definition"></a></dt>
<dd><p>Extracts the elastic tensor from the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>list</strong> – Symmetrized elastic tensor as a 6x6 nested list.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_input">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Properties_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_input" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create a properties_input object</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_input.from_file">
<span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_input.from_file" title="Link to this definition"></a></dt>
<dd><p>Read the properties input from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_name</strong> (<em>str</em>) – The name of the input file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> (<em>Properties_input</em>) – The Properties_input object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_input.make_newk_block">
<span class="sig-name descname"><span class="pre">make_newk_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shrink1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_input.make_newk_block" title="Link to this definition"></a></dt>
<dd><p>Returns the newk block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shrink1</strong> (<em>int</em>) – The first newk shrinking factor.</p></li>
<li><p><strong>shrink2</strong> (<em>int</em>) – The second newk shrinking factor.</p></li>
<li><p><strong>Fermi</strong> (<em>int</em>) – Fermi recalculation option (default is 1).</p></li>
<li><p><strong>print_option</strong> (<em>int</em>) – Properties printing option (default is 0).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_input.make_bands_block">
<span class="sig-name descname"><span class="pre">make_bands_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_kpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BAND</span> <span class="pre">STRUCTURE</span> <span class="pre">CALCULATION'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_input.make_bands_block" title="Link to this definition"></a></dt>
<dd><p>Returns the bands block for a bands calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_path</strong> (<em>list</em><em> or </em><em>HighSymmKpath</em>) – The k-path for the bands calculation.</p></li>
<li><p><strong>n_kpoints</strong> (<em>int</em>) – The number of k-points along the path.</p></li>
<li><p><strong>first_band</strong> (<em>int</em>) – The index of the first band.</p></li>
<li><p><strong>last_band</strong> (<em>int</em>) – The index of the last band.</p></li>
<li><p><strong>print_eig</strong> (<em>int</em>) – Printing options for eigenvalues (default is 0).</p></li>
<li><p><strong>print_option</strong> (<em>int</em>) – Properties printing options (default is 1).</p></li>
<li><p><strong>precision</strong> (<em>int</em>) – Number of zeros in the calculation of the gcd</p></li>
<li><p><strong>title</strong> (<em>str</em>) – The title of the calculation (default is ‘BAND STRUCTURE CALCULATION’).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_input.make_doss_block">
<span class="sig-name descname"><span class="pre">make_doss_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotting_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_input.make_doss_block" title="Link to this definition"></a></dt>
<dd><p>Returns the doss block for a doss calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_points</strong> (<em>int</em>) – The number of points in the DOS plot (default is 200).</p></li>
<li><p><strong>band_range</strong> (<em>list</em><em> or </em><em>tuple</em>) – The range of bands to include in the DOS calculation (default is None).</p></li>
<li><p><strong>e_range</strong> (<em>list</em><em> or </em><em>tuple</em>) – The energy range for the DOS calculation (default is None).</p></li>
<li><p><strong>plotting_option</strong> (<em>int</em>) – DOS plotting options (default is 2).</p></li>
<li><p><strong>poly</strong> (<em>int</em>) – Degree of the polynomial for smearing (default is 12).</p></li>
<li><p><strong>print_option</strong> (<em>int</em>) – Properties printing options (default is 1).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_input.make_pdoss_block">
<span class="sig-name descname"><span class="pre">make_pdoss_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'atom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotting_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_input.make_pdoss_block" title="Link to this definition"></a></dt>
<dd><p>Returns the pdoss block for a pdoss calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>projections</strong> (<em>dict</em>) – Dictionary specifying the projections for the pdoss calculation.</p></li>
<li><p><strong>proj_type</strong> (<em>str</em>) – Type of projection (‘atom’ or ‘site’) (default is ‘atom’).</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – Output file name (default is None).</p></li>
<li><p><strong>n_points</strong> (<em>int</em>) – The number of points in the DOS plot (default is 200).</p></li>
<li><p><strong>band_range</strong> (<em>list</em><em> or </em><em>tuple</em>) – The range of bands to include in the DOS calculation (default is None).</p></li>
<li><p><strong>e_range</strong> (<em>list</em><em> or </em><em>tuple</em>) – The energy range for the DOS calculation (default is None).</p></li>
<li><p><strong>plotting_option</strong> (<em>int</em>) – DOS plotting options (default is 2).</p></li>
<li><p><strong>poly</strong> (<em>int</em>) – Degree of the polynomial for smearing (default is 12).</p></li>
<li><p><strong>print_option</strong> (<em>int</em>) – Properties printing options (default is 1).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_input.write_properties_input">
<span class="sig-name descname"><span class="pre">write_properties_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_input.write_properties_input" title="Link to this definition"></a></dt>
<dd><p>Writes the properties input to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_name</strong> (<em>str</em>) – The name of the output file.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Properties_output</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates a Properties_output object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_file">
<span class="sig-name descname"><span class="pre">read_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_file" title="Link to this definition"></a></dt>
<dd><p>Parse the properties output file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – The properties output file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Properties_output</strong> – The updated Properties_output object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_electron_band">
<span class="sig-name descname"><span class="pre">read_electron_band</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_electron_band" title="Link to this definition"></a></dt>
<dd><p>Generate bands object from CRYSTAL BAND.DAT or fort.25 file.
Energy unit: eV. E Fermi is aligned to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>band_file</strong> (<em>str</em>) – Name of BAND.DAT or fort.25 file</p></li>
<li><p><strong>output</strong> (<em>str</em>) – Properties output file (.outp or .out). For 3D k
coordinates and geometry information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.bands</strong> (<em>BandsBASE</em>) – A Bands base object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_electron_dos">
<span class="sig-name descname"><span class="pre">read_electron_dos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_electron_dos" title="Link to this definition"></a></dt>
<dd><p>Generate doss object from CRYSTAL DOSS.DAT or fort.25 file.
Energy unit: eV. E Fermi is aligned to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – File name</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.doss</strong> (<em>DOSBASE</em>) – A DOS base object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_bands">
<span class="sig-name descname"><span class="pre">read_cry_bands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_bands" title="Link to this definition"></a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_doss">
<span class="sig-name descname"><span class="pre">read_cry_doss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_doss" title="Link to this definition"></a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_contour">
<span class="sig-name descname"><span class="pre">read_cry_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_contour" title="Link to this definition"></a></dt>
<dd><p>Read the CRYSTAL contour files to create the contour objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – The properties output file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Properties_output</strong> – The updated Properties_output object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_xrd_spec">
<span class="sig-name descname"><span class="pre">read_cry_xrd_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_xrd_spec" title="Link to this definition"></a></dt>
<dd><p>Read XRD spectrum data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – Path to the properties output file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The modified object with extracted XRD spectrum data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_rholine">
<span class="sig-name descname"><span class="pre">read_cry_rholine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_rholine" title="Link to this definition"></a></dt>
<dd><p>Read density line data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – Path to the properties output file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The modified object with extracted density line data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_seebeck">
<span class="sig-name descname"><span class="pre">read_cry_seebeck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_seebeck" title="Link to this definition"></a></dt>
<dd><p>Read Seebeck coefficient data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – Path to the properties output file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The modified object with extracted Seebeck coefficient data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_sigma">
<span class="sig-name descname"><span class="pre">read_cry_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_sigma" title="Link to this definition"></a></dt>
<dd><p>Read electrical conductivity data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – Path to the properties output file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The modified object with extracted electrical conductivity data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_lapl_profile">
<span class="sig-name descname"><span class="pre">read_cry_lapl_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_lapl_profile" title="Link to this definition"></a></dt>
<dd><p>Read Laplacian profile data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – Path to the properties output file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The modified object with extracted Laplacian profile data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_density_profile">
<span class="sig-name descname"><span class="pre">read_cry_density_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_density_profile" title="Link to this definition"></a></dt>
<dd><p>Read density profile data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – Path to the properties output file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The modified object with extracted density profile data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_vecfield">
<span class="sig-name descname"><span class="pre">read_vecfield</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which_prop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_vecfield" title="Link to this definition"></a></dt>
<dd><p>Reads the fort.25 file to return data arrays containing one or more vectiorial density properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>properties_output</strong> (<em>str</em>) – The properties output file.</p></li>
<li><p><strong>which_prop</strong> (<em>str</em>) – The density property selected by the user.</p></li>
<li><p><strong>'m'</strong> (<em>magnetization</em><em>)</em><em>, </em><em>'j'</em><em> (</em><em>spin current</em><em>)</em><em>, </em><em>'J'</em><em> (</em><em>spin current density</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Properties_output</strong> (<em>str</em>) – The fort.25 output file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_ECHG">
<span class="sig-name descname"><span class="pre">read_cry_ECHG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_ECHG" title="Link to this definition"></a></dt>
<dd><p>Read density profile data from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – Path to the fort.25 file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The modified object with extracted ECHG data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Properties_output.read_cry_ECHG_delta">
<span class="sig-name descname"><span class="pre">read_cry_ECHG_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties_output1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties_output2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Properties_output.read_cry_ECHG_delta" title="Link to this definition"></a></dt>
<dd><p>Read density profile data from two files and plots the difference.
It is important that the header stays the same for the two output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>properties_output1</strong> (<em>str</em>) – Path to first fort.25 file.</p></li>
<li><p><strong>properties_output2</strong> (<em>str</em>) – Path to second fort.25 file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The modified object with extracted ECHG data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_gui">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Crystal_gui</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_gui" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class can read a CRYSTAL gui file into an object or substrate
information of the object to generate a gui file.</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_gui.read_gui">
<span class="sig-name descname"><span class="pre">read_gui</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gui_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_gui.read_gui" title="Link to this definition"></a></dt>
<dd><p>This is used mainly to convert the object into an ASE or pymatgen
object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gui_file</strong> (<em>str</em>) – The CRYSTAL structure (gui) file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_gui.write_gui">
<span class="sig-name descname"><span class="pre">write_gui</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gui_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_gui.write_gui" title="Link to this definition"></a></dt>
<dd><p>Write a CRYSTAL gui file (to file)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gui_file</strong> (<em>str</em>) – The name of the gui that is going to be written (
including .gui).</p></li>
<li><p><strong>symm</strong> (<em>bool</em>) – Whether to include symmetry operations.</p></li>
<li><p><strong>pseudo_atoms</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – A list of atoms whose core is described
by a pseudopotential</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_density">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Crystal_density</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_density" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Read density data from a .f98 file.</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.Crystal_density.read_cry_irr_density">
<span class="sig-name descname"><span class="pre">read_cry_irr_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fort98_unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.Crystal_density.read_cry_irr_density" title="Link to this definition"></a></dt>
<dd><p>Read density profile data from a CRYSTAL .f98 file.
:param fort98_unit: The file containing the formatted density matrix.
:type fort98_unit: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
</dl>
<p>Note:
This is a work in progress. If you are interested in this functionality,
please open an Issue on GitHub.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.cry_combine_density">
<span class="sig-name descname"><span class="pre">cry_combine_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'new_density.f98'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_pol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.cry_combine_density" title="Link to this definition"></a></dt>
<dd><p>Combine density matrix files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density1</strong> (<em>str</em>) – The first density matrix file.</p></li>
<li><p><strong>density2</strong> (<em>str</em>) – The second density matrix file.</p></li>
<li><p><strong>density3</strong> (<em>str</em>) – The density matrix file for the whole system.</p></li>
<li><p><strong>new_density</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the new density matrix. Defaults to ‘new_density.f98’.</p></li>
<li><p><strong>spin_pol</strong> (<em>bool</em><em>, </em><em>optional</em>) – Specifies if the system is spin polarized. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a work in progress. If you are interested in this functionality,
please open an Issue on GitHub.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.write_cry_density">
<span class="sig-name descname"><span class="pre">write_cry_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fort98_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_fort98</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.write_cry_density" title="Link to this definition"></a></dt>
<dd><p>Write the formatted density matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fort98_name</strong> (<em>str</em>) – The name of the previous density matrix file.</p></li>
<li><p><strong>new_p</strong> (<em>list</em>) – The new density matrix.</p></li>
<li><p><strong>new_fort98</strong> (<em>str</em>) – The name of the new density matrix file.</p></li>
<li><p><strong>Returns</strong></p></li>
<li><p><strong>None</strong></p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a work in progress. If you are interested in this functionality,
please open an Issue on GitHub.</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.External_unit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">External_unit</span></span><a class="headerlink" href="#CRYSTALClear.crystal_io.External_unit" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.External_unit.read_external_unit">
<span class="sig-name descname"><span class="pre">read_external_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">external_unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.External_unit.read_external_unit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.External_unit.read_cry_irspec">
<span class="sig-name descname"><span class="pre">read_cry_irspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">external_unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.External_unit.read_cry_irspec" title="Link to this definition"></a></dt>
<dd><p>Reads the IRSPEC.DAT unit produced by CRYSTAL ir spectra computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>external_unit</strong> (<em>str</em>) – path to the IRSPEC.DAT file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>The crystal_object necessary to plot the simulated spectra with plot_cry_irspec()</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.External_unit.read_cry_ramspec">
<span class="sig-name descname"><span class="pre">read_cry_ramspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">external_unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.External_unit.read_cry_ramspec" title="Link to this definition"></a></dt>
<dd><p>Reads the RAMSPEC.DAT unit produced by CRYSTAL raman spectra computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>external_unit</strong> (<em>str</em>) – path to the RAMSPEC.DAT file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>The crystal_object necessary to plot the simulated spectra with plot_cry_ramspec()</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.External_unit.read_phonon_band">
<span class="sig-name descname"><span class="pre">read_phonon_band</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.External_unit.read_phonon_band" title="Link to this definition"></a></dt>
<dd><p>Generate bands object from CRYSTAL PHONBAND.DAT or fort.25 file.
Energy unit: eV. E Fermi is aligned to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>band_file</strong> (<em>str</em>) – Name of PHONBAND.DAT or fort.25 file</p></li>
<li><p><strong>output</strong> (<em>str</em>) – Properties output file (.outp or .out). For 3D k
coordinates and geometry information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.bands</strong> (<em>BandsBASE</em>) – A Bands base object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.crystal_io.External_unit.read_phonon_dos">
<span class="sig-name descname"><span class="pre">read_phonon_dos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">external_unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.crystal_io.External_unit.read_phonon_dos" title="Link to this definition"></a></dt>
<dd><p>Generate doss object from CRYSTAL PHONONDOSS.DAT or fort.25 file.
Energy unit: eV. E Fermi is aligned to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>properties_output</strong> (<em>str</em>) – File name</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.doss</strong> (<em>DOSBASE</em>) – A DOS base object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-CRYSTALClear.execute">
<span id="crystalclear-execute"></span><h2>CRYSTALClear.execute<a class="headerlink" href="#module-CRYSTALClear.execute" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.execute.set_runcry_path">
<span class="sig-name descname"><span class="pre">set_runcry_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.execute.set_runcry_path" title="Link to this definition"></a></dt>
<dd><p>Set the path for the Runcry executable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – The path to the Runcry executable.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.execute.set_runprop_path">
<span class="sig-name descname"><span class="pre">set_runprop_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.execute.set_runprop_path" title="Link to this definition"></a></dt>
<dd><p>Set the path for the Runprop executable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – The path to the Runprop executable.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.execute.runcry">
<span class="sig-name descname"><span class="pre">runcry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guessp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.execute.runcry" title="Link to this definition"></a></dt>
<dd><p>Run Runcry calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>str</em>) – The name of the file to run the calculation.</p></li>
<li><p><strong>guessp</strong> (<em>str</em><em>, </em><em>optional</em>) – The guessp parameter. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>str</strong> – The result of the calculation or an error message.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.execute.runprop">
<span class="sig-name descname"><span class="pre">runprop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prop_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.execute.runprop" title="Link to this definition"></a></dt>
<dd><p>Run Runprop calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prop_name</strong> (<em>str</em>) – The name of the property to calculate.</p></li>
<li><p><strong>wf_file</strong> (<em>str</em>) – The name of the wavefunction file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>str</strong> – The result of the calculation or an error message.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-CRYSTALClear.flatmaps">
<span id="crystalclear-flatmaps"></span><h2>CRYSTALClear.flatmaps<a class="headerlink" href="#module-CRYSTALClear.flatmaps" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ElectricChargeDensity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ElectricChargeDensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fort25_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Angstrom'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ElectricChargeDensity" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#CRYSTALClear.crystal_io.Properties_output" title="CRYSTALClear.crystal_io.Properties_output"><code class="xref py py-class docutils literal notranslate"><span class="pre">Properties_output</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ElectricChargeDensity.change_units">
<span class="sig-name descname"><span class="pre">change_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ElectricChargeDensity.change_units" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ElectricChargeDensity.add_map">
<span class="sig-name descname"><span class="pre">add_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'p'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ElectricChargeDensity.add_map" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ElectricChargeDensity.log_scale">
<span class="sig-name descname"><span class="pre">log_scale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ElectricChargeDensity.log_scale" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ElectricChargeDensity.set_cmaprange">
<span class="sig-name descname"><span class="pre">set_cmaprange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Angstrom'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ElectricChargeDensity.set_cmaprange" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ElectricChargeDensity.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gnuplot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ElectricChargeDensity.plot" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.OrbitalMagnetizationField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OrbitalMagnetizationField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fort25_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Angstrom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quivdens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.OrbitalMagnetizationField" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#CRYSTALClear.crystal_io.Properties_output" title="CRYSTALClear.crystal_io.Properties_output"><code class="xref py py-class docutils literal notranslate"><span class="pre">Properties_output</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.OrbitalMagnetizationField.change_units">
<span class="sig-name descname"><span class="pre">change_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.OrbitalMagnetizationField.change_units" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.OrbitalMagnetizationField.add_map">
<span class="sig-name descname"><span class="pre">add_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'p'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.OrbitalMagnetizationField.add_map" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.OrbitalMagnetizationField.log_scale">
<span class="sig-name descname"><span class="pre">log_scale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.OrbitalMagnetizationField.log_scale" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.OrbitalMagnetizationField.set_cmaprange">
<span class="sig-name descname"><span class="pre">set_cmaprange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.OrbitalMagnetizationField.set_cmaprange" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.OrbitalMagnetizationField.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gnuplot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.OrbitalMagnetizationField.plot" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ChargeCurrentField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ChargeCurrentField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fort25_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Angstrom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quivdens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ChargeCurrentField" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#CRYSTALClear.crystal_io.Properties_output" title="CRYSTALClear.crystal_io.Properties_output"><code class="xref py py-class docutils literal notranslate"><span class="pre">Properties_output</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ChargeCurrentField.change_units">
<span class="sig-name descname"><span class="pre">change_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ChargeCurrentField.change_units" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ChargeCurrentField.add_map">
<span class="sig-name descname"><span class="pre">add_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'p'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ChargeCurrentField.add_map" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ChargeCurrentField.log_scale">
<span class="sig-name descname"><span class="pre">log_scale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ChargeCurrentField.log_scale" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ChargeCurrentField.set_cmaprange">
<span class="sig-name descname"><span class="pre">set_cmaprange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ChargeCurrentField.set_cmaprange" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.ChargeCurrentField.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gnuplot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.ChargeCurrentField.plot" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.SpinCurrentField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SpinCurrentField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fort25_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Angstrom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quivdens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.SpinCurrentField" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#CRYSTALClear.crystal_io.Properties_output" title="CRYSTALClear.crystal_io.Properties_output"><code class="xref py py-class docutils literal notranslate"><span class="pre">Properties_output</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.SpinCurrentField.change_units">
<span class="sig-name descname"><span class="pre">change_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.SpinCurrentField.change_units" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.SpinCurrentField.add_map">
<span class="sig-name descname"><span class="pre">add_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'p'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.SpinCurrentField.add_map" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.SpinCurrentField.log_scale">
<span class="sig-name descname"><span class="pre">log_scale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.SpinCurrentField.log_scale" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.SpinCurrentField.set_cmaprange">
<span class="sig-name descname"><span class="pre">set_cmaprange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.SpinCurrentField.set_cmaprange" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.flatmaps.SpinCurrentField.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gnuplot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.flatmaps.SpinCurrentField.plot" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-CRYSTALClear.geometry">
<span id="crystalclear-geometry"></span><h2>CRYSTALClear.geometry<a class="headerlink" href="#module-CRYSTALClear.geometry" title="Link to this heading"></a></h2>
<p>Basic methods to manipulate pymatgen geometries</p>
<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.geometry.rotate_lattice">
<span class="sig-name descname"><span class="pre">rotate_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.geometry.rotate_lattice" title="Link to this definition"></a></dt>
<dd><p>Geometries generated by <code class="docutils literal notranslate"><span class="pre">base.crysout.GeomBASE</span></code> might be rotated.
Rotate them back to make them consistent with geometries in output.</p>
<div class="math notranslate nohighlight">
\[\mathbf{L}_{crys} = \mathbf{L}_{pmg}\mathbf{R}\]</div>
<p><span class="math notranslate nohighlight">\(\mathbf{R}\)</span> is the rotation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>struc</strong> (<em>Structure</em>) – Pymatgen structure</p></li>
<li><p><strong>rot</strong> (<em>array</em>) – 3*3 numpy array, rotation matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>struc_new</strong> (<em>Structure</em>) – Pymatgen structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.geometry.refine_geometry">
<span class="sig-name descname"><span class="pre">refine_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struc</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.geometry.refine_geometry" title="Link to this definition"></a></dt>
<dd><p>Get refined geometry. Useful when reducing the cell to the irrducible
one. 3D only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>struc</strong> (<em>Structure</em>) – Pymatgen structure</p></li>
<li><p><strong>**kwargs</strong> – <p>Passed to Pymatgen <a class="reference external" href="https://pymatgen.org/pymatgen.symmetry.html#pymatgen.symmetry.analyzer.SpacegroupAnalyzer">SpacegroupAnalyzer</a> object.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sg</strong> (<em>int</em>) – Space group number</p></li>
<li><p><strong>struc5</strong> (<em>Structure</em>) – Irrducible structure that is consistent with
International Crystallographic Table</p></li>
<li><p><strong>latt</strong> (<em>list</em>) – minimal set of crystallographic cell parameters</p></li>
<li><p><strong>natom_irr</strong> (<em>int</em>) – number of irrducible atoms</p></li>
<li><p><strong>atom</strong> (<em>list</em>) – natom*4 array. 1st element: atomic number; 2-4:
fractional coordinates</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.geometry.get_pcel">
<span class="sig-name descname"><span class="pre">get_pcel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.geometry.get_pcel" title="Link to this definition"></a></dt>
<dd><p>Restore the supercell to primitive cell, with the origin shifted to the
middle of lattice to utilize symmetry (as the default of CRYSTAL).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>struc</strong> (<em>Structure</em>) – Pymatgen structure of supercell</p></li>
<li><p><strong>smx</strong> (<em>array</em>) – 3*3 array of supercell expansion matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pcel</strong> (<em>Structure</em>) – Pymatgen structure of primitive cell</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.geometry.get_scel">
<span class="sig-name descname"><span class="pre">get_scel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.geometry.get_scel" title="Link to this definition"></a></dt>
<dd><p>Get the supercell from primitive cell, with the origin shifted to the
middle of lattice to utilize symmetry (as the default of CRYSTAL).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>struc</strong> (<em>Structure</em>) – Pymatgen structure of supercell</p></li>
<li><p><strong>smx</strong> (<em>array</em>) – 3*3 array of supercell expansion matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scel</strong> (<em>Structure</em>) – Pymatgen structure of supercell</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.geometry.get_sg_symmops">
<span class="sig-name descname"><span class="pre">get_sg_symmops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struc</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.geometry.get_sg_symmops" title="Link to this definition"></a></dt>
<dd><p>Get space group number and corresponding symmetry operations. To keep
consistency with International Crystallographic Table, refined geometry
is suggested.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>struc</strong> (<em>Structure</em>) – Pymatgen Structure object.</p></li>
<li><p><strong>**kwargs</strong> – Passed to Pymatgen SpacegroupAnalyzer object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sg</strong> (<em>int</em>) – Space group number</p></li>
<li><p><strong>n_symmops</strong> (<em>int</em>) – number of symmetry operations</p></li>
<li><p><strong>symmops</strong> (<em>array</em>) – n_symmops*4*3 array of symmetry operations</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.geometry.Miller_norm">
<span class="sig-name descname"><span class="pre">Miller_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">miller</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.geometry.Miller_norm" title="Link to this definition"></a></dt>
<dd><p>Find the norm vector of a specified Miller plane</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>struc</strong> (<em>Structure</em>) – Pymatgen Structure object.</p></li>
<li><p><strong>miller</strong> (<em>array</em><em> | </em><em>list</em>) – 3*1 list of Miller index</p></li>
<li><p><strong>d</strong> (<em>fload</em>) – Length of norm vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vec</strong> (<em>array</em>) – 3*1 norm vector, normalized to 1.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-CRYSTALClear.plot">
<span id="crystalclear-plot"></span><h2>CRYSTALClear.plot<a class="headerlink" href="#module-CRYSTALClear.plot" title="Link to this heading"></a></h2>
<p>Functions to visualize physical properties computed with CRYSTAL .</p>
<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_dens_ECHG">
<span class="sig-name descname"><span class="pre">plot_dens_ECHG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_echg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'echg_map'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_dens_ECHG" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>Plots the 2D ECHG density map from a fort.25 file.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>obj_echg (crystal_io.Properties_output): Properties output object.
levels (int or array-like, optional): Determines the number and positions of the contour lines/regions. Default is 150.
xticks (int, optional): Number of ticks in the x direction. Default is 5.
yticks (int, optional): Number of ticks in the y direction. Default is 5.
cmap_max(float, optional): Maximum value used for the colormap. Default is None.
cmap_min(float, optional): Minimun value used for the colormap. Default is None.
dpi (int, optional): DPI (dots per inch) for the output image. Default is 400.
savefig (bool): Chose to save the figure or not. Default is False.
name (str): Name for the colormap.</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_vecfield2D_m">
<span class="sig-name descname"><span class="pre">plot_vecfield2D_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quivscale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MAG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_vecfield2D_m" title="Link to this definition"></a></dt>
<dd><p>Plots the 2D magnetization vector field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header</strong> (<em>list</em>) – List containing information about the fort.25 header.</p></li>
<li><p><strong>dens</strong> (<em>numpy.ndarray</em>) – Array containing the vector field data.</p></li>
<li><p><strong>quivscale</strong> (<em>float</em>) – Scale factor for the quiver plot.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name used for saving the plots.</p></li>
<li><p><strong>levels</strong> (<em>int</em><em> or </em><em>array-like</em><em>, </em><em>optional</em>) – Determines the number and positions of the contour lines/regions.</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – DPI (dots per inch) for the output image. Default is 400.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_vecfield2D_j">
<span class="sig-name descname"><span class="pre">plot_vecfield2D_j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quivscale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SC'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_vecfield2D_j" title="Link to this definition"></a></dt>
<dd><p>Plots the 2D vector field of the spin current.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header</strong> (<em>list</em>) – List containing information about the fort.25 header.</p></li>
<li><p><strong>dens</strong> (<em>numpy.ndarray</em>) – Array representing the vector field.</p></li>
<li><p><strong>quivscale</strong> (<em>float</em>) – Scale factor for the quiver plot.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name used for saving the plots.</p></li>
<li><p><strong>levels</strong> (<em>int</em><em> or </em><em>array-like</em><em>, </em><em>optional</em>) – Determines the number and positions of the contour lines/regions.</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – DPI (dots per inch) for the output image. Defaults to 400.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_vecfield2D_J">
<span class="sig-name descname"><span class="pre">plot_vecfield2D_J</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens_JX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens_JY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens_JZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quivscale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SCD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_vecfield2D_J" title="Link to this definition"></a></dt>
<dd><p>Plots the 2D spin current density vector fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>header</strong> (<em>list</em>) – List containing information about the fort.25 header.</p></li>
<li><p><strong>dens_JX</strong> (<em>numpy.ndarray</em>) – Array representing the X-component of the spin current density.</p></li>
<li><p><strong>dens_JY</strong> (<em>numpy.ndarray</em>) – Array representing the Y-component of the spin current density.</p></li>
<li><p><strong>dens_JZ</strong> (<em>numpy.ndarray</em>) – Array representing the Z-component of the spin current density.</p></li>
<li><p><strong>quivscale</strong> – Scale factor for the quiver plot.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name used for saving the plots.</p></li>
<li><p><strong>levels</strong> (<em>int</em><em> or </em><em>array-like</em><em>, </em><em>optional</em>) – Determines the number and positions of the contour lines/regions.</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – DPI (Dots per inch) for saving the plots. Defaults to 400.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_phonon_band">
<span class="sig-name descname"><span class="pre">plot_phonon_band</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cm-1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">not_scaled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_freq0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_phonon_band" title="Link to this definition"></a></dt>
<dd><p>A wrapper of plot_cry_bands for phonon band structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bands</strong> (<a class="reference internal" href="CRYSTALClear.base.html#CRYSTALClear.base.propout.BandsBASE" title="CRYSTALClear.base.propout.BandsBASE"><em>BandsBASE</em></a><em>|</em><em>list</em>) – Bands object generated by <cite>CRYSTALClear.crystal_io.Crystal_output.read_pband</cite> or
a list of BandsBASE objects.</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – The unit of frequency. Can be ‘cm-1’ or ‘THz’.</p></li>
<li><p><strong>k_labels</strong> (<em>list</em>) – A list of high-symmetric k point labels. Greek alphabets should be, for example, ‘Gamma’.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – The plotting mode. Possible values are ‘single’, ‘multi’, and ‘compare’.</p></li>
<li><p><strong>not_scaled</strong> (<em>bool</em>) – Whether to scale the x-axis for different volumes.</p></li>
<li><p><strong>energy_range</strong> (<em>array</em>) – A 2x1 array specifying the energy range.</p></li>
<li><p><strong>k_range</strong> (<em>array</em>) – A 2x1 array specifying the k-range.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>|</em><em>list</em>) – Color of plot lines. Should be consistent with bands.</p></li>
<li><p><strong>labels</strong> (<em>str</em><em>|</em><em>list</em>) – Plot legend. Should be consistent with bands.</p></li>
<li><p><strong>linestl</strong> (<em>str</em><em>|</em><em>list</em>) – Linestyle string. Should be consistent with bands.</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – The width of the plot lines.</p></li>
<li><p><strong>line_freq0</strong> (<em>str</em>) – The color of the frequency=0 line.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – The title of the plot.</p></li>
<li><p><strong>figsize</strong> (<em>list</em>) – The figure size specified as [width, height].</p></li>
<li><p><strong>scheme</strong> (<em>list</em><em>|</em><em>tuple</em>) – The layout of subplots.</p></li>
<li><p><strong>sharex</strong> (<em>bool</em>) – Whether to share the x-axis among subplots.</p></li>
<li><p><strong>sharey</strong> (<em>bool</em>) – Whether to share the y-axis among subplots.</p></li>
<li><p><strong>dpi</strong> (<em>int</em>) – Dots per inch resolution of the saved file.</p></li>
<li><p><strong>fontsize</strong> (<em>int</em>) – Fontsize of the axis labels.</p></li>
<li><p><strong>transparency</strong> (<em>bool</em>) – Background transparency of the saved file,</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Matplotlib object</strong></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the specified unit is unknown.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_electron_band">
<span class="sig-name descname"><span class="pre">plot_electron_band</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">not_scaled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'forestgreen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fermiwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fermialpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_electron_band" title="Link to this definition"></a></dt>
<dd><p>A wrapper of plot_cry_bands for electron band structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bands</strong> (<a class="reference internal" href="CRYSTALClear.base.html#CRYSTALClear.base.propout.BandsBASE" title="CRYSTALClear.base.propout.BandsBASE"><em>BandsBASE</em></a><em>|</em><em>list</em>) – Bands object generated by <cite>CRYSTALClear.crystal_io.Properties_output.read_bands</cite> or
a list of BandsBASE objects.</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – The unit of energy. Can be ‘eV’ or ‘Hartree’.</p></li>
<li><p><strong>k_labels</strong> (<em>list</em>) – A list of high-symmetric k point labels. Greek alphabets should be, for example, ‘Gamma’.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – The plotting mode. Possible values are ‘single’, ‘multi’, and ‘compare’.</p></li>
<li><p><strong>not_scaled</strong> (<em>bool</em>) – Whether to scale the x-axis for different volumes.</p></li>
<li><p><strong>energy_range</strong> (<em>array</em>) – A 2x1 array specifying the energy range.</p></li>
<li><p><strong>k_range</strong> (<em>array</em>) – A 2x1 array specifying the k-range.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>|</em><em>list</em>) – Color of plot lines. Should be consistent with bands.</p></li>
<li><p><strong>labels</strong> (<em>str</em><em>|</em><em>list</em>) – Plot legend. Should be consistent with bands.</p></li>
<li><p><strong>linestl</strong> (<em>str</em><em>|</em><em>list</em>) – Linestyle string. Should be consistent with bands.</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – The width of the plot lines.</p></li>
<li><p><strong>fermi</strong> (<em>str</em>) – The color of the Fermi level line.</p></li>
<li><p><strong>fermiwidth</strong> (<em>float</em>) – The width of the fermi line.</p></li>
<li><p><strong>fermialpha</strong> (<em>float</em>) – Opacity of the fermi level 0-1.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – The title of the plot.</p></li>
<li><p><strong>figsize</strong> (<em>list</em>) – The figure size specified as [width, height].</p></li>
<li><p><strong>scheme</strong> (<em>list</em><em>|</em><em>tuple</em>) – The layout of subplots.</p></li>
<li><p><strong>sharex</strong> (<em>bool</em>) – Whether to share the x-axis among subplots.</p></li>
<li><p><strong>sharey</strong> (<em>bool</em>) – Whether to share the y-axis among subplots.</p></li>
<li><p><strong>dpi</strong> (<em>int</em>) – Dots per inch resolution of the saved file.</p></li>
<li><p><strong>fontsize</strong> (<em>int</em>) – Fontsize of the axis labels</p></li>
<li><p><strong>transparency</strong> – Background Transparency of the saved file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Matplolib object</strong></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the specified unit is unknown.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_electron_dos">
<span class="sig-name descname"><span class="pre">plot_electron_dos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'up'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'forestgreen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_electron_dos" title="Link to this definition"></a></dt>
<dd><p>A wrapper of plot_cry_doss for electron density of states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doss</strong> (<a class="reference internal" href="CRYSTALClear.base.html#CRYSTALClear.base.propout.DOSBASE" title="CRYSTALClear.base.propout.DOSBASE"><em>DOSBASE</em></a>) – DOS obect generated by code:<cite>CRYSTALClear.crystal_io.Properties_output.read_doss</cite>.
Or a list of DOSBASE objects.</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – ‘eV’ or ‘Hartree’</p></li>
<li><p><strong>beta</strong> (<em>str</em>) – Plot spin-down state ‘up’ or ‘down’</p></li>
<li><p><strong>overlap</strong> (<em>bool</em>) – Plotting multiple lines into the same figure</p></li>
<li><p><strong>prj</strong> (<em>list</em>) – Index of selected projection. Consistent with the
index of the 2nd dimension of <code class="code docutils literal notranslate"><span class="pre">doss.doss</span></code></p></li>
<li><p><strong>energy_range</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – 2*1 list of energy range</p></li>
<li><p><strong>dos_range</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – 2*1 list of DOS range</p></li>
<li><p><strong>color</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Color of plot lines. <em>Should be
consistent with number of projections.</em></p></li>
<li><p><strong>labels</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Plot legend. <em>Should be consistent with
number of projections.</em></p></li>
<li><p><strong>linestl</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – linestyle string. <em>Should be consistent
with number of projections.</em></p></li>
<li><p><strong>linewidth</strong> (<em>float</em>)</p></li>
<li><p><strong>fermi</strong> (<em>str</em>) – Color of Fermi level line.</p></li>
<li><p><strong>title</strong> (<em>str</em>)</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Matplotlib object</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_phonon_dos">
<span class="sig-name descname"><span class="pre">plot_phonon_dos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cm-1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_freq0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_phonon_dos" title="Link to this definition"></a></dt>
<dd><p>A wrapper of plot_cry_doss for electron density of states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doss</strong> (<a class="reference internal" href="CRYSTALClear.base.html#CRYSTALClear.base.propout.DOSBASE" title="CRYSTALClear.base.propout.DOSBASE"><em>DOSBASE</em></a>) – DOS obect generated by code:<cite>CRYSTALClear.crystal_io.Crystal_output.read_pdos</cite>.
Or a list of DOSBASE objects.</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – ‘cm-1’ or ‘THz’</p></li>
<li><p><strong>overlap</strong> (<em>bool</em>) – Plotting multiple lines into the same figure</p></li>
<li><p><strong>prj</strong> (<em>list</em>) – Index of selected projection. Consistent with the
index of the 2nd dimension of <code class="code docutils literal notranslate"><span class="pre">doss.doss</span></code></p></li>
<li><p><strong>freq_range</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – 2*1 list of frequency range</p></li>
<li><p><strong>dos_range</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – 2*1 list of DOS range</p></li>
<li><p><strong>color</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Color of plot lines. <em>Should be
consistent with number of projections.</em></p></li>
<li><p><strong>labels</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Plot legend. <em>Should be consistent with
number of projections.</em></p></li>
<li><p><strong>linestl</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – linestyle string. <em>Should be consistent
with number of projections.</em></p></li>
<li><p><strong>linewidth</strong> (<em>float</em>)</p></li>
<li><p><strong>line_freq0</strong> (<em>str</em>) – Color of frequency = 0 line.</p></li>
<li><p><strong>title</strong> (<em>str</em>)</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Matplotlib object</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_electron_banddos">
<span class="sig-name descname"><span class="pre">plot_electron_banddos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'down'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_prj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_dos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestl_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestl_dos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fermi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'forestgreen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_electron_banddos" title="Link to this definition"></a></dt>
<dd><p>A wrapper of plot_cry_es for electron band structure + dos. For spin-polarized cases, beta state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bands</strong> (<a class="reference internal" href="CRYSTALClear.base.html#CRYSTALClear.base.propout.BandsBASE" title="CRYSTALClear.base.propout.BandsBASE"><em>BandsBASE</em></a><em>|</em><em>list</em>) – Bands object generated by CRYSTALClear.crystal_io.Properties_output.read_bands
or a list of BandsBASE objects.</p></li>
<li><p><strong>doss</strong> (<a class="reference internal" href="CRYSTALClear.base.html#CRYSTALClear.base.propout.DOSBASE" title="CRYSTALClear.base.propout.DOSBASE"><em>DOSBASE</em></a>) – DOS object generated by CRYSTALClear.crystal_io.Properties_output.read_doss
or a list of DOSBASE objects.</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – Unit of energy. Valid options are ‘eV’ or ‘Hartree’.</p></li>
<li><p><strong>k_labels</strong> (<em>list</em>) – A list of high-symmetric k point labels. Greek alphabets should be
represented as strings, for example, ‘Gamma’.</p></li>
<li><p><strong>dos_beta</strong> (<em>str</em>) – Spin state to plot. Valid options are ‘Up’ or ‘down’. If ‘down’, the beta
state will be plotted on the same side as the alpha state, otherwise on the other side.</p></li>
<li><p><strong>dos_prj</strong> (<em>list</em>) – Index of selected projection. Consistent with the index of the 2nd dimension
of doss.doss.</p></li>
<li><p><strong>energy_range</strong> (<em>list</em>) – A list of two values representing the energy range to be plotted.</p></li>
<li><p><strong>dos_range</strong> (<em>list</em>) – DOS range for the y-axis.</p></li>
<li><p><strong>color_band</strong> (<em>str</em>) – Color of the electron bands in the plot.</p></li>
<li><p><strong>color_dos</strong> (<em>str</em>) – Color of the density of states (DOS) in the plot.</p></li>
<li><p><strong>labels</strong> (<em>list</em>) – A list of labels for the plot legend.</p></li>
<li><p><strong>linestl_band</strong> (<em>str</em>) – Linestyle of the electron bands.</p></li>
<li><p><strong>linestl_dos</strong> (<em>str</em>) – Linestyle of the density of states (DOS).</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – Width of the lines in the plot.</p></li>
<li><p><strong>fermi</strong> (<em>str</em>) – Color of the Fermi level line.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title of the plot.</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Size of the figure in inches (width, height).</p></li>
<li><p><strong>legend</strong> (<em>bool</em>) – Enables or disables the legend of the density of states (DOS).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Matplotlib object</strong></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the unit parameter is unknown.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_phonon_banddos">
<span class="sig-name descname"><span class="pre">plot_phonon_banddos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cm-1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_prj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dos_max_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_dos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestl_band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestl_dos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq0_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_phonon_banddos" title="Link to this definition"></a></dt>
<dd><p>A wrapper of plot_cry_es for phonon band structure + dos. Only one pair is permitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bands</strong> (<a class="reference internal" href="CRYSTALClear.base.html#CRYSTALClear.base.propout.BandsBASE" title="CRYSTALClear.base.propout.BandsBASE"><em>BandsBASE</em></a><em>|</em><em>list</em>) – Bands object generated by CRYSTALClear.crystal_io.Properties_output.read_bands
or a list of BandsBASE objects.</p></li>
<li><p><strong>doss</strong> (<a class="reference internal" href="CRYSTALClear.base.html#CRYSTALClear.base.propout.DOSBASE" title="CRYSTALClear.base.propout.DOSBASE"><em>DOSBASE</em></a>) – DOS object generated by CRYSTALClear.crystal_io.Properties_output.read_doss
or a list of DOSBASE objects.</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – Unit of frequency. Valid options are ‘cm-1’ or ‘THz’.</p></li>
<li><p><strong>k_labels</strong> (<em>list</em>) – A list of high-symmetric k point labels. Greek alphabets should be
represented as strings, for example, ‘Gamma’.</p></li>
<li><p><strong>dos_prj</strong> (<em>list</em>) – Index of selected projection. Consistent with the index of the 2nd dimension
of doss.doss.</p></li>
<li><p><strong>freq_range</strong> (<em>list</em>) – A list of two values representing the frequency range to be plotted.</p></li>
<li><p><strong>dos_max_range</strong> (<em>float</em>) – Maximum DOS range for the y-axis.</p></li>
<li><p><strong>color_band</strong> (<em>str</em>) – Color of the phonon bands in the plot.</p></li>
<li><p><strong>color_dos</strong> (<em>str</em>) – Color of the density of states (DOS) in the plot.</p></li>
<li><p><strong>labels</strong> (<em>list</em>) – A list of labels for the plot legend.</p></li>
<li><p><strong>linestl_band</strong> (<em>str</em>) – Linestyle of the phonon bands.</p></li>
<li><p><strong>linestl_dos</strong> (<em>str</em>) – Linestyle of the density of states (DOS).</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – Width of the lines in the plot.</p></li>
<li><p><strong>freq0_line</strong> (<em>str</em>) – Color of the frequency=0 line.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title of the plot.</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Size of the figure in inches (width, height).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Matplotlib object</strong></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the unit parameter is unknown.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_contour">
<span class="sig-name descname"><span class="pre">plot_cry_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contour_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_contour" title="Link to this definition"></a></dt>
<dd><p>Plot a contour plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>contour_obj</strong> (<em>object</em>) – Contour object representing the contour plot.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Plots a contour plot based on the data in the contour object.</p></li>
<li><p>Retrieves the data from the contour object and converts it to a 2D list.</p></li>
<li><p>Sets the figure size based on x_graph_param and y_graph_param attributes of the contour object.</p></li>
<li><p>Sets the x-axis and y-axis labels.</p></li>
<li><p>Creates a meshgrid using the x_points and y_points attributes of the contour object.</p></li>
<li><p>Defines contour levels, colors, linestyles, and fmt.</p></li>
<li><p>Plots the contour plot.</p></li>
<li><p>Saves the plot to a file named ‘figure_TIPO_YYYY-MM-DD_HHMMSS.jpg’ in the current directory.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_contour_differences">
<span class="sig-name descname"><span class="pre">plot_cry_contour_differences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contour_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_obj_ref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_contour_differences" title="Link to this definition"></a></dt>
<dd><p>Plot the differences between two contour plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contour_obj</strong> (<em>object</em>) – Contour object representing the original contour plot.</p></li>
<li><p><strong>contour_obj_ref</strong> (<em>object</em>) – Contour object representing the reference contour plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Plots the differences between two contour plots.</p></li>
<li><p>Requires the contour objects to have a tipo attribute with values ‘SURFLAPP’, ‘SURFLAPM’, ‘SURFRHOO’, or ‘SURFELFB’.</p></li>
<li><p>Calculates the difference between the dataframes of the two contour objects.</p></li>
<li><p>Sets the figure size based on x_graph_param and y_graph_param attributes of the contour object.</p></li>
<li><p>Sets the x-axis and y-axis labels.</p></li>
<li><p>Creates a meshgrid using the x_points and y_points attributes of the contour object.</p></li>
<li><p>Defines contour levels, colors, and linestyles.</p></li>
<li><p>Plots the contour differences.</p></li>
<li><p>Saves the plot to a file named ‘figure_diff_TIPO_YYYY-MM-DD_HHMMSS.jpg’ in the current directory.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_xrd">
<span class="sig-name descname"><span class="pre">plot_cry_xrd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xrd_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_xrd" title="Link to this definition"></a></dt>
<dd><p>Plot the X-ray diffraction pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xrd_obj</strong> (<em>object</em>) – XRD object containing the data for the X-ray diffraction pattern.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Plots the X-ray diffraction pattern.</p></li>
<li><p>Sets the figure size to [16, 9].</p></li>
<li><p>Sets the x-axis limit to (0, 30).</p></li>
<li><p>Saves the plot to a file named ‘figure_XRD_YYYY-MM-DD_HHMMSS.jpg’ in the current directory.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_rholine">
<span class="sig-name descname"><span class="pre">plot_cry_rholine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rholine_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_rholine" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>Plot the resistivity as a function of distance.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>rholine_obj (object): Rholine object containing the data for the resistivity.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>Plots the resistivity as a function of distance.</p></li>
<li><p>Sets the x-axis label as ‘d  [$AA$]’ and the y-axis label as r’$</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<p>ho$  [$
rac{e}{AA^3}$]’.</p>
<blockquote>
<div><ul class="simple">
<li><p>Saves the plot to a file named ‘figure_rholine_YYYY-MM-DD_HHMMSS.jpg’ in the current directory.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_lapl_profile">
<span class="sig-name descname"><span class="pre">plot_cry_lapl_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lapl_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_lapl_profile" title="Link to this definition"></a></dt>
<dd><p>Plot the Laplacian profile of a crystal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lapl_obj</strong> (<em>object</em>) – Laplacian object containing the data for the Laplacian profile.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Plots the Laplacian profile using the data from the Laplacian object.</p></li>
<li><p>The x-axis represents the distance in angstroms.</p></li>
<li><p>The y-axis represents the Laplacian in electrons per cubic angstrom to the fifth power (e/A^5).</p></li>
<li><p>The area under the curve where the Laplacian is negative is filled with a light blue color.</p></li>
<li><p>The area under the curve where the Laplacian is positive is filled with a light coral color.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_density_profile">
<span class="sig-name descname"><span class="pre">plot_cry_density_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lapl_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_density_profile" title="Link to this definition"></a></dt>
<dd><p>Plot the density profile of a crystal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lapl_obj</strong> (<em>object</em>) – Laplacian object containing the data for the density profile.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Plots the density profile using the data from the Laplacian object.</p></li>
<li><p>The x-axis represents the distance in angstroms.</p></li>
<li><p>The y-axis represents the density in electrons per cubic angstrom (e/A^3).</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_seebeck_potential">
<span class="sig-name descname"><span class="pre">plot_cry_seebeck_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seebeck_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_seebeck_potential" title="Link to this definition"></a></dt>
<dd><p>Plot the Seebeck coefficient as a function of chemical potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seebeck_obj</strong> (<em>object</em>) – Seebeck object containing the data for the Seebeck coefficient.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Prompts the user to choose the direction to plot among S_xx, S_xy, S_xz, S_yx, S_yy, S_yz, S_yz, S_zx, S_zy, S_zz.</p></li>
<li><p>Plots the Seebeck coefficient as a function of chemical potential for each temperature.</p></li>
<li><p>Distinguishes between n-type and p-type conduction with dashed and solid lines, respectively.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_seebeck_carrier">
<span class="sig-name descname"><span class="pre">plot_cry_seebeck_carrier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seebeck_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_seebeck_carrier" title="Link to this definition"></a></dt>
<dd><p>Plot the Seebeck coefficient as a function of charge carrier concentration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seebeck_obj</strong> – Seebeck object containing the data for the Seebeck coefficient.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Prompts the user to choose the direction to plot among S_xx, S_xy, S_xz, S_yx, S_yy, S_yz, S_yz, S_zx, S_zy, S_zz.</p></li>
<li><p>Plots the Seebeck coefficient as a function of charge carrier concentration for each temperature, distinguishing between n-type and p-type conduction.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_multiseebeck">
<span class="sig-name descname"><span class="pre">plot_cry_multiseebeck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">seebeck</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_multiseebeck" title="Link to this definition"></a></dt>
<dd><p>Plot the multiseebeck coefficient for different temperatures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*seebeck</strong> – Variable number of seebeck objects containing the data for the Seebeck coefficient.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Prompts the user to input the index of the temperature to plot.</p></li>
<li><p>Prompts the user to input the lower and higher values of chemical potential to plot in eV.</p></li>
<li><p>Prompts the user to choose the direction to plot among S_xx, S_xy, S_xz, S_yx, S_yy, S_yz, S_yz, S_zx, S_zy, S_zz.</p></li>
<li><p>Plots the multiseebeck coefficient for each seebeck object.</p></li>
<li><p>Differentiates transport coefficients due to n-type or p-type conduction using dashed and solid lines.</p></li>
<li><p>Saves the plot to a file named ‘multiseebeckYYYY-MM-DD_HHMMSS.jpg’, where YYYY-MM-DD_HHMMSS represents the current date and time.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_sigma_potential">
<span class="sig-name descname"><span class="pre">plot_cry_sigma_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_sigma_potential" title="Link to this definition"></a></dt>
<dd><p>Plot the electrical conductivity as a function of chemical potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sigma_obj</strong> (<em>object</em>) – Sigma object containing the data for electrical conductivity.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Prompts the user to choose the direction to plot among S_xx, S_xy, S_xz, S_yy, S_yz, S_zz.</p></li>
<li><p>Plots the electrical conductivity as a function of chemical potential for each temperature.</p></li>
<li><p>Distinguishes between n-type and p-type conduction with dashed and solid lines, respectively.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_sigma_carrier">
<span class="sig-name descname"><span class="pre">plot_cry_sigma_carrier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_sigma_carrier" title="Link to this definition"></a></dt>
<dd><p>Plot the electrical conductivity as a function of charge carrier concentration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sigma_obj</strong> – Sigma object containing the data for the electrical conductivity.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Prompts the user to choose the direction to plot among S_xx, S_xy, S_xz, S_yy, S_yz, S_zz.</p></li>
<li><p>Plots the electrical conductivity as a function of charge carrier concentration for each temperature, distinguishing between n-type and p-type conduction.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_multisigma">
<span class="sig-name descname"><span class="pre">plot_cry_multisigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_multisigma" title="Link to this definition"></a></dt>
<dd><p>Plot the multisigma conductivity for different temperatures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*sigma</strong> – Variable number of sigma objects containing the data for the conductivity.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Prompts the user to input the index of the temperature to plot.</p></li>
<li><p>Prompts the user to input the lower and higher values of chemical potential to plot in eV.</p></li>
<li><p>Prompts the user to choose the direction to plot among S_xx, S_xy, S_xz, S_yy, S_yz, S_zz.</p></li>
<li><p>Plots the multisigma conductivity for each sigma object.</p></li>
<li><p>Differentiates transport coefficients due to n-type or p-type conduction using dashed and solid lines.</p></li>
<li><p>Saves the plot to a file named ‘multisigmaYYYY-MM-DD_HHMMSS.jpg’, where YYYY-MM-DD_HHMMSS represents the current date and time.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_powerfactor_potential">
<span class="sig-name descname"><span class="pre">plot_cry_powerfactor_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seebeck_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_powerfactor_potential" title="Link to this definition"></a></dt>
<dd><p>Plot the power factor for different potentials.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seebeck_obj</strong> – Seebeck object containing the data for the Seebeck coefficient.</p></li>
<li><p><strong>sigma_obj</strong> – Sigma object containing the data for the electrical conductivity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Prompts the user to choose the direction to plot among PF_xx, PF_xy, PF_xz, PF_yx, PF_yy, PF_yz, PF_yz, PF_zx, PF_zy, PF_zz.</p></li>
<li><p>Calculates the power factor using the Seebeck coefficient and electrical conductivity data for each temperature.</p></li>
<li><p>Plots the power factor for each temperature as a function of the chemical potential, distinguishing between n-type and p-type conduction.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_powerfactor_carrier">
<span class="sig-name descname"><span class="pre">plot_cry_powerfactor_carrier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seebeck_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_powerfactor_carrier" title="Link to this definition"></a></dt>
<dd><p>Plot the power factor for different charge carrier concentrations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seebeck_obj</strong> – Seebeck object containing the data for the Seebeck coefficient.</p></li>
<li><p><strong>sigma_obj</strong> – Sigma object containing the data for the electrical conductivity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Prompts the user to choose the direction to plot among PF_xx, PF_xy, PF_xz, PF_yx, PF_yy, PF_yz, PF_yz, PF_zx, PF_zy, PF_zz.</p></li>
<li><p>Calculates the power factor using the Seebeck coefficient and electrical conductivity data for each temperature.</p></li>
<li><p>Plots the power factor for each temperature as a function of the charge carrier concentration, distinguishing between n-type and p-type conduction.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_zt">
<span class="sig-name descname"><span class="pre">plot_cry_zt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seebeck_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_zt" title="Link to this definition"></a></dt>
<dd><p>Plot the ZT value for different temperatures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seebeck_obj</strong> – Seebeck object containing the data for the Seebeck coefficient.</p></li>
<li><p><strong>sigma_obj</strong> – Sigma object containing the data for the electrical conductivity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Prompts the user to input the value of ktot in W-1K-1m-1.</p></li>
<li><p>Prompts the user to choose the direction to plot among ZT_xx, ZT_xy, ZT_xz, ZT_yx, ZT_yy, ZT_yz, ZT_yz, ZT_zx, ZT_zy, ZT_zz.</p></li>
<li><p>Calculates the ZT value using the Seebeck coefficient and electrical conductivity data.</p></li>
<li><p>Plots the ZT value for each temperature as a function of the chemical potential.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_young">
<span class="sig-name descname"><span class="pre">plot_cry_young</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_young" title="Link to this definition"></a></dt>
<dd><p>Compute Young’s modulus for each direction of the space (i.e., each pair
of theta and phi angles).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em>) – Theta value.</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – Phi value.</p></li>
<li><p><strong>S</strong> (<em>numpy.ndarray</em>) – Compliance matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>float</strong> – Young’s modulus values.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function is intended to be called by cry_ela_plot</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_comp">
<span class="sig-name descname"><span class="pre">plot_cry_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_comp" title="Link to this definition"></a></dt>
<dd><p>Compute linear compressibility for each direction of the space (i.e., each
pair of theta and phi angles).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em>) – Theta value.</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – Phi value.</p></li>
<li><p><strong>S</strong> (<em>numpy.ndarray</em>) – Compliance matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>float</strong> – Linear compressibility values.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function is intended to be called by cry_ela_plot</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_shear">
<span class="sig-name descname"><span class="pre">plot_cry_shear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta_1D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_1D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear_choice</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_shear" title="Link to this definition"></a></dt>
<dd><p>For each direction of the space (i.e., for each pair
of theta and phi angles) the shear modulus is computed for the third angle
chi and the average, maximum and minimum values are stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta_1D</strong> (<em>numpy.ndarray</em>) – One-dimensional array of theta values.</p></li>
<li><p><strong>phi_1D</strong> (<em>numpy.ndarray</em>) – One-dimensional array of phi values.</p></li>
<li><p><strong>S</strong> (<em>numpy.ndarray</em>) – Compliance matrix.</p></li>
<li><p><strong>ndeg</strong> (<em>int</em>) – Number of degrees for discretization.</p></li>
<li><p><strong>shear_choice</strong> (<em>str</em>) – Type of shear property to plot. Options: “avg”, “min”, “max”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numpy.ndarray</strong> – Shear property array.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function is intended to be called by cry_ela_plot</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_poisson">
<span class="sig-name descname"><span class="pre">plot_cry_poisson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta_1D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_1D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poisson_choice</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_poisson" title="Link to this definition"></a></dt>
<dd><p>For each direction of the space (i.e., for each pair
of theta and phi angles) the Poisson ratio is computed for the third angle
chi and the average, maximum and minimum values are stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta_1D</strong> (<em>numpy.ndarray</em>) – One-dimensional array of theta values.</p></li>
<li><p><strong>phi_1D</strong> (<em>numpy.ndarray</em>) – One-dimensional array of phi values.</p></li>
<li><p><strong>S</strong> (<em>numpy.ndarray</em>) – Compliance matrix.</p></li>
<li><p><strong>ndeg</strong> (<em>int</em>) – Number of degrees for discretization.</p></li>
<li><p><strong>poisson_choice</strong> (<em>str</em>) – Type of Poisson’s ratio to plot. Options: “avg”, “min”, “max”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numpy.ndarray</strong> – Poisson’s ratio array.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function is intended to be called by cry_ela_plot</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_ela">
<span class="sig-name descname"><span class="pre">plot_cry_ela</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">choose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndeg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_ela" title="Link to this definition"></a></dt>
<dd><p>Plot crystal elastic properties on the basis of the elastic tensor. A
variable number of elastic tensors can be provided in order to get
multiple plots in one shot, establishing a fixed color scale among them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>choose</strong> (<em>str</em>) – Property to plot. Options: “young”, “comp”, “shear avg”, “shear min”, “shear max”, “poisson avg”, “poisson min”, “poisson max”.</p></li>
<li><p><strong>ndeg</strong> (<em>int</em>) – Number of degrees for discretization.</p></li>
<li><p><strong>*args</strong> – Variable number of elastic tensors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Tuple of lists</strong></p></li>
<li><p><strong>- fig_list</strong> – list of matplotlib.figure.Figure
A list containing matplotlib Figure objects for each plot.</p></li>
<li><p><strong>- ax_list</strong> – list of matplotlib.axes._axes.Axes
A list containing the Axes objects associated with each plot.</p></li>
<li><p><strong>- plt_list</strong> – list of matplotlib.pyplot
A list of the pyplot objects for each plot, representing the actual plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_irspec">
<span class="sig-name descname"><span class="pre">plot_cry_irspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cm-1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab:blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_irspec" title="Link to this definition"></a></dt>
<dd><p>Generates the IR spectra for the IRSPEC.DAT file produced by an IRSPEC calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>irspec</strong> (<em>External_unit object</em>) – Object generated by the read_cry_irspec function necessary for the plot</p></li>
<li><p><strong>x_unit</strong> (<em>str</em><em>, </em><em>optional</em>) – Unit measure of the x axes. Avalilable: ‘cm-1’ and ‘nm’. Defaults to ‘cm-1’.</p></li>
<li><p><strong>y_mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Peak broadening modality in absorbance and reflectance.
Available: ‘LG’(Lorentzian-Gaussian broadening), ‘V’ (Voight broadening), ‘RS’ (Rayleigh spherical particles), ‘RE’ (Rayleigh with elipsoid particles), ‘REFL’ (Reflectance)
Defaults to ‘LG’.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Image dimensions correspondig to matplotlib figsize. Defaults to None.</p></li>
<li><p><strong>linestyle</strong> (<em>str/list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – linestyle corresponding to the matplotlib one it can be a list for a multiplot. Defaults to ‘-‘.</p></li>
<li><p><strong>linewidth</strong> (<em>float/list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – linewidth corresponding to the matplotlib one it can be a list for a multiplot. Defaults to 1.5.</p></li>
<li><p><strong>color</strong> (<em>str/list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Color of the spectra it can accept all matplotlib colors it can be a list for multiplots. Defaults to ‘tab:blue’.</p></li>
<li><p><strong>freq_range</strong> (<em>list</em><em>, </em><em>optional</em>) – Two element list [min, max], that allows to visualize the spectra in a given frequency window. Defaults to None.</p></li>
<li><p><strong>int_range</strong> (<em>list</em><em>, </em><em>optional</em>) – Two element list [min, max], that allows to visualize the spectra in a given intensity window. Defaults to None.</p></li>
<li><p><strong>label</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – List of labels for the legend of a multiplot. Defaults to None.</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – Resolution of the saved file. Defaults to 300.</p></li>
<li><p><strong>transparency</strong> (<em>bool</em><em>, </em><em>optional</em>) – Enables the transparency of the saved file background. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Matplotlib object</strong></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – The function raises an error when the object to be plotted does not have the required y_mode</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_ramspec">
<span class="sig-name descname"><span class="pre">plot_cry_ramspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ramspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'total'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab:blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_ramspec" title="Link to this definition"></a></dt>
<dd><p>Generates the RAMAN spectra for the RAMSPEC.DAT file produced by an RAMSPEC calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>irspec</strong> (<em>External_unit object</em>) – Object generated by the read_cry_ramspec function necessary for the plot</p></li>
<li><p><strong>y_mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Polarization of the spectra for the simulated compound
Available: ‘total’, ‘parallel’, ‘perpendicular’ (for powders), ‘xx’, ‘xy’, ‘xz’, ‘yy’, ‘yz’, ‘zz’ (for single crystals)
Defaults to ‘LG’.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Image dimensions correspondig to matplotlib figsize. Defaults to None.</p></li>
<li><p><strong>linestyle</strong> (<em>str/list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – linestyle corresponding to the matplotlib one it can be a list for a multiplot. Defaults to ‘-‘.</p></li>
<li><p><strong>linewidth</strong> (<em>float/list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – linewidth corresponding to the matplotlib one it can be a list for a multiplot. Defaults to 1.5.</p></li>
<li><p><strong>color</strong> (<em>str/list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Color of the spectra it can accept all matplotlib colors it can be a list for multiplots. Defaults to ‘tab:blue’.</p></li>
<li><p><strong>freq_range</strong> (<em>list</em><em>, </em><em>optional</em>) – Two element list [min, max], that allows to visualize the spectra in a given frequency window. Defaults to None.</p></li>
<li><p><strong>int_range</strong> (<em>list</em><em>, </em><em>optional</em>) – Two element list [min, max], that allows to visualize the spectra in a given intensity window. Defaults to None.</p></li>
<li><p><strong>label</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – List of labels for the legend of a multiplot. Defaults to None.</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – Resolution of the saved file. Defaults to 300.</p></li>
<li><p><strong>transparency</strong> (<em>bool</em><em>, </em><em>optional</em>) – Enables the transparency of the saved file background. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Matplotlib object</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_spec">
<span class="sig-name descname"><span class="pre">plot_cry_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transitions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typeS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">';'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_csv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Wavenumber</span> <span class="pre">[cm$^{-1}$]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Intensity</span> <span class="pre">[arb.</span> <span class="pre">u.]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compstyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nopadding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">6)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_spec" title="Link to this definition"></a></dt>
<dd><p>This function enables the simulation of vibrational spectra based on a 2D
NumPy array containing a list of transition frequencies and the
corresponding intensities. The code allows users to model spectral
broadening according to various profiles (Gaussian, Lorentzian,
pseudo-Voigt), or zero broadening (Dirac deltas-like lines). Please, note
that by turning the optional argument ‘component’ to <cite>True</cite> you can
additionally plot contributions arising from each transition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transitions</strong> (<em>float</em><em>|</em><em>numpy.ndarray</em>) – Array containing transition frequencies</p></li>
<li><p><strong>intensities</strong> (<em>(</em><em>axis=0</em><em>) </em><em>and corresponding</em>)</p></li>
<li><p><strong>typeS</strong> (<em>str</em>) – String specifying the spectral profile: ‘bars’,</p></li>
<li><p><strong>'lorentz'</strong></p></li>
<li><p><strong>'gauss'</strong></p></li>
<li><p><strong>'pvoigt'.</strong></p></li>
<li><p><strong>components</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot contributions arising from</p></li>
<li><p><strong>transition</strong> (<em>each</em>)</p></li>
<li><p><strong>bwidth</strong> (<em>float</em><em>, </em><em>optional</em>) – Half-width at half-maximum of the Lorentzian</p></li>
<li><p><strong>profile</strong> (<em>default is 0.5</em>)</p></li>
<li><p><strong>stdev</strong> (<em>float</em><em>, </em><em>optional</em>) – Standard deviation of the Gaussian profile</p></li>
<li><p><strong>5</strong><strong>)</strong><strong>.</strong> (<em>(</em><em>default is</em>)</p></li>
<li><p><strong>eta</strong> (<em>float</em><em>, </em><em>optional</em>) – Fraction of Lorentzian character in pseudo-Voigt</p></li>
<li><p><strong>profile</strong></p></li>
<li><p><strong>fmin</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum frequency.</p></li>
<li><p><strong>fmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum frequency.</p></li>
<li><p><strong>ylim</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum intensity.</p></li>
<li><p><strong>savefig</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to save the figure (default is <cite>False</cite>).</p></li>
<li><p><strong>dpi</strong> (<em>float</em><em>, </em><em>optional</em>) – Dots per inches (default is 300).</p></li>
<li><p><strong>filetype</strong> (<em>str</em><em>, </em><em>optional</em>) – File extension (default is ‘png’).</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to show the figure (default is <cite>True</cite>).</p></li>
<li><p><strong>export_csv</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to save plot in csv format (default is</p></li>
<li><p><strong>False</strong><strong>)</strong><strong>.</strong></p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – x-axis label (default is ‘Wavenumber [cm$^{-1}$]’).</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – y-axis label (default is ‘Intensity [arb. u.]’).</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – Linewidth (default is 2.0).</p></li>
<li><p><strong>padd</strong> (<em>float</em><em>, </em><em>optional</em>) – left- and right- hand side padding expressed in the</p></li>
<li><p><strong>x-axis</strong> (<em>same unit</em><em> of </em><em>the quantity reported in</em>)</p></li>
<li><p><strong>fontsize</strong> (<em>integer</em><em>, </em><em>optional</em>) – Fontsize (default is 12).</p></li>
<li><p><strong>style</strong> (<em>str</em><em>, </em><em>optional</em>) – String specifying Matplotlib style.</p></li>
<li><p><strong>compstyle</strong> (<em>str</em><em>|</em><em>list</em><em>, </em><em>optional</em>) – List containing Matplotlib styles to plot</p></li>
<li><p><strong>component.</strong> (<em>each</em>)</p></li>
<li><p><strong>nopadding</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to remove padding (default is <cite>False</cite>).</p></li>
<li><p><strong>figsize</strong> (<em>real</em><em>|</em><em>list</em><em>, </em><em>optional</em>) – List of two numbers specifying the aspect</p></li>
<li><p><strong>figure</strong> (<em>ratio</em><em> of </em><em>the</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>:class:`matplotlib.pyplot`</strong></p></li>
<li><p><strong>A matplotlib object representing the result of the plot</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_spec_multi">
<span class="sig-name descname"><span class="pre">plot_cry_spec_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typeS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Wavenumber</span> <span class="pre">[cm$^{-1}$]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Intensity</span> <span class="pre">[arb.</span> <span class="pre">u.]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nopadding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">';'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_spec_multi" title="Link to this definition"></a></dt>
<dd><p>This function is a wrapper for <cite>plot_spec</cite> function, enablng the simulation
of many vibrational spectra coming from a list of NumPy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transitions</strong> (<em>float</em><em>|</em><em>numpy.ndarray</em>) – Array containing transition frequencies</p></li>
<li><p><strong>intensities</strong> (<em>(</em><em>axis=0</em><em>) </em><em>and corresponding</em>)</p></li>
<li><p><strong>typeS</strong> (<em>str</em>) – String specifying the spectral profile: ‘bars’,</p></li>
<li><p><strong>'lorentz'</strong></p></li>
<li><p><strong>'gauss'</strong></p></li>
<li><p><strong>'pvoigt'.</strong></p></li>
<li><p><strong>components</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot contributions arising from</p></li>
<li><p><strong>transition</strong> (<em>each</em>)</p></li>
<li><p><strong>bwidth</strong> (<em>float</em><em>, </em><em>optional</em>) – Half-width at half-maximum of the Lorentzian</p></li>
<li><p><strong>profile</strong> (<em>default is 0.5</em>)</p></li>
<li><p><strong>stdev</strong> (<em>float</em><em>, </em><em>optional</em>) – Standard deviation of the Gaussian profile</p></li>
<li><p><strong>5</strong><strong>)</strong><strong>.</strong> (<em>(</em><em>default is</em>)</p></li>
<li><p><strong>eta</strong> (<em>float</em><em>, </em><em>optional</em>) – Fraction of Lorentzian character in pseudo-Voigt</p></li>
<li><p><strong>profile</strong></p></li>
<li><p><strong>fmin</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum frequency.</p></li>
<li><p><strong>fmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum frequency</p></li>
<li><p><strong>ylim</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum intensity.</p></li>
<li><p><strong>savefig</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to save the figure (default is <cite>False</cite>).</p></li>
<li><p><strong>dpi</strong> (<em>float</em><em>, </em><em>optional</em>) – Dots per inches (default is 300).</p></li>
<li><p><strong>filetype</strong> (<em>str</em><em>, </em><em>optional</em>) – File extension (default is ‘png’).</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – x-axis label (default is ‘Wavenumber [cm$^{-1}$]’).</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – y-axis label (default is ‘Intensity [arb. u.]’).</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – Linewidth (default is 2.0).</p></li>
<li><p><strong>padd</strong> (<em>float</em><em>, </em><em>optional</em>) – left- and right- hand side padding expressed in the</p></li>
<li><p><strong>x-axis</strong> (<em>same unit</em><em> of </em><em>the quantity reported in</em>)</p></li>
<li><p><strong>fontsize</strong> (<em>integer</em><em>, </em><em>optional</em>) – Fontsize (default is 12).</p></li>
<li><p><strong>style</strong> (<em>str</em><em>, </em><em>optional</em>) – String specifying Matplotlib style.</p></li>
<li><p><strong>nopadding</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to remove padding (default is <cite>False</cite>).</p></li>
<li><p><strong>figsize</strong> (<em>real</em><em>|</em><em>list</em><em>, </em><em>optional</em>) – List of two numbers specifying the aspect</p></li>
<li><p><strong>figure</strong> (<em>ratio</em><em> of </em><em>the</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>:class:`matplotlib.pyplot`</strong></p></li>
<li><p><strong>A matplotlib object representing the result of the plot</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.plot.plot_cry_anscan">
<span class="sig-name descname"><span class="pre">plot_cry_anscan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">co</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_wf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">harmpot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scanpot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">10]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.plot.plot_cry_anscan" title="Link to this definition"></a></dt>
<dd><p>This function provides a plotting tool for the ANSCAN keyword.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>co</strong> (<a class="reference internal" href="#CRYSTALClear.crystal_io.Crystal_output" title="CRYSTALClear.crystal_io.Crystal_output"><em>crystal_io.Crystal_output</em></a>) – Crystal output object.</p></li>
<li><p><strong>scale_wf</strong> (<em>float</em><em>, </em><em>optional</em>) – Scaling factor for wavefunctions plot. By</p></li>
<li><p><strong>default</strong> (<em>plot. By</em>)</p></li>
<li><p><strong>this</strong> (<em>wavefunctions are not plotted. Providing a value for</em>)</p></li>
<li><p><strong>accordingly.</strong> (<em>scales it</em>)</p></li>
<li><p><strong>scale_prob</strong> (<em>float</em><em>, </em><em>optional</em>) – Scaling factor for probability density</p></li>
<li><p><strong>default</strong></p></li>
<li><p><strong>a</strong> (<em>probability densities are not plotted. Providing</em>)</p></li>
<li><p><strong>and</strong> (<em>value for this argument enables the probability density plot</em>)</p></li>
<li><p><strong>accordingly.</strong></p></li>
<li><p><strong>harmpot</strong> (<em>bool</em><em>, </em><em>optional</em>) – A logical flag to activate the plotting of</p></li>
<li><p><strong>potential</strong> (<em>the harmonic</em>)</p></li>
<li><p><strong>scanpot</strong> (<em>bool</em><em>, </em><em>optional</em>) – A logical flag to activate the plotting of</p></li>
<li><p><strong>ANSCAN</strong> (<em>the scan potential provided by</em>)</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>:class:`matplotlib.pyplot`</strong></p></li>
<li><p><strong>A matplotlib object representing the result of the plot</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-CRYSTALClear.thermodynamics">
<span id="crystalclear-thermodynamics"></span><h2>CRYSTALClear.thermodynamics<a class="headerlink" href="#module-CRYSTALClear.thermodynamics" title="Link to this heading"></a></h2>
<p>A post-processing module for DFT lattice dynamics by harmonic and quasiharmonic
approximations (HA/QHA).</p>
<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Mode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Mode" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines a vibrational mode and do analysis per mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rank</strong> (<em>int</em>) – The rank of the mode object, from 1.</p></li>
<li><p><strong>frequency</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Frequencies of the mode
(Ncalc*1). Unit: THz. Note: <strong>NOT</strong> angular frequency, which is
frequency * 2pi.</p></li>
<li><p><strong>volume</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Lattice volumes of harmonic
calculations (Ncalc*1). Unit: Angstrom^3</p></li>
<li><p><strong>eigenvector</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Corresponding normalized
eigenvectors (Ncalc*Natom*3).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.rank</strong> (<em>int</em>)</p></li>
<li><p><strong>self.ncalc</strong> (<em>int</em>) – The number of harmonic calculations (typically at
different volumes)</p></li>
<li><p><strong>self.frequency</strong> (<em>array[float]</em>)</p></li>
<li><p><strong>self.volume</strong> (<em>array[float]</em>)</p></li>
<li><p><strong>self.eigenvector</strong> (<em>array[float]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Mode.get_zp_energy">
<span class="sig-name descname"><span class="pre">get_zp_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Mode.get_zp_energy" title="Link to this definition"></a></dt>
<dd><p>Get the zero-point energy of a single mode. <em>ncalc = 1 only</em>.</p>
<div class="math notranslate nohighlight">
\[E^{zp}_{i,\mathbf{q}}=\frac{1}{2}\hbar\omega_{i,\mathbf{q}}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.zp_energy</strong> (<em>float</em>) – Zero-point energy. Unit: KJ/mol</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Mode.get_u_vib">
<span class="sig-name descname"><span class="pre">get_u_vib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">298.15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Mode.get_u_vib" title="Link to this definition"></a></dt>
<dd><p>Get the vibration contribution to internal energy (including zero-point
energy) of a single mode. <em>ncalc = 1 only</em>.</p>
<div class="math notranslate nohighlight">
\[U^{vib}_{i,\mathbf{q}}\left(T\right)=E^{zp}_{i,\mathbf{q}}+
\frac{\hbar\omega_{i,\mathbf{q}}}{\exp{\left(
    \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
\right)}-1}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Temperature where the quantity is
computed. Unit: K</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.u_vib</strong> (<em>float</em>) – Vibration contribution to internal energy.
Unit: KJ/mol</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Mode.get_entropy">
<span class="sig-name descname"><span class="pre">get_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Mode.get_entropy" title="Link to this definition"></a></dt>
<dd><p>Get the entropy of a single mode. <em>ncalc = 1 only</em>.</p>
<div class="math notranslate nohighlight">
\[S_{i,\mathbf{q}}\left(T\right)=k_{B}\left\{
    \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T\left[
        \exp{\left(
            \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
        \right)}-1
    \right]}-\ln{\left[
        1-\exp{\left(
            -\frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
        \right)}
    \right]}
\right\}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Unit: K</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.entropy</strong> (<em>float</em>) – Entropy. Unit: J/mol*K</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Mode.get_c_v">
<span class="sig-name descname"><span class="pre">get_c_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Mode.get_c_v" title="Link to this definition"></a></dt>
<dd><p>Get the constant volume specific heat of a single mode. <em>ncalc = 1 only</em>.</p>
<div class="math notranslate nohighlight">
\[C^{V}_{i,\mathbf{q}}=
\frac{\left(\hbar\omega_{i,\mathbf{q}}\right)^{2}}{k_{B}T^{2}}
\frac{\exp{
\left(
    \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
\right)}
}{\left[
    \exp{\left(
        \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
    \right)-1}
\right]^{2}
}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Unit: K</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.c_v</strong> (<em>float</em>) – Constant volume specific heat. Unit: J/mol*K</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Mode.get_classical_amplitude">
<span class="sig-name descname"><span class="pre">get_classical_amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Mode.get_classical_amplitude" title="Link to this definition"></a></dt>
<dd><p>Empty method - development ongoing</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Mode.polynomial_fit">
<span class="sig-name descname"><span class="pre">polynomial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Mode.polynomial_fit" title="Link to this definition"></a></dt>
<dd><p>Fit phonon frequency as the polynomial function of volume. <em>ncalc &gt; 1 only</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To improve the accuracy of fittings, <span class="math notranslate nohighlight">\(\Delta\omega(\Delta V)\)</span>
is fitted as a polynomial function without the constant term.</p>
<p><span class="math notranslate nohighlight">\(\Delta V=V-V_{min}\)</span> is used so HA phonons of the most compact
structure is kept. See ‘FIXINDEX’ keyword in CRYSTAL manual for
further information.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<em>array</em><em>[</em><em>int</em><em>] </em><em>| </em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Orders of polynomials.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.poly_fit</strong> (<em>Dict[int, NumPy Polynomial]</em>) – Key - orders of power,
Value - fitted NumPy polynomials</p></li>
<li><p><strong>self.poly_fit_rsquare</strong> (<em>Dict[int, float]</em>) – Key - orders of power,
Value - goodness of fittings, characterized by R^2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Mode.get_gruneisen">
<span class="sig-name descname"><span class="pre">get_gruneisen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Mode.get_gruneisen" title="Link to this definition"></a></dt>
<dd><p>Return to mode Grüneisen parameter. <em>ncalc &gt; 1 only</em>.</p>
<div class="math notranslate nohighlight">
\[\gamma = -\frac{V}{\omega(V)}\frac{\partial\omega}{\partial V}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em><em> | </em><em>list</em><em>[</em><em>int</em><em>]</em>) – See <code class="docutils literal notranslate"><span class="pre">polynomial_fit</span></code></p></li>
<li><p><strong>volume</strong> (<em>float</em><em> | </em><em>array</em>) – Typically the equilibrium volume</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.gruneisen</strong> (<em>dict</em>) – Key, order; Value, Gruneisen parameter</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Harmonic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Harmonic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocalc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Harmonic" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for harmonic phonon calclulations. It can be parameterized from a
CRYSTAL output file, phonopy ouput file or by setting all the information
(usually for QHA).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Temperatures
where thermodynamic properties are computed. Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Pressures where
the thermodyanmic properties are calculated. Unit: GPa</p></li>
<li><p><strong>filename</strong> (<em>str</em><em> | </em><em>None</em>) – Name of the printed-out file. If None, do not
print out file.</p></li>
<li><p><strong>autocalc</strong> (<em>bool</em>) – Automatically launch calculations.</p></li>
</ul>
</dd>
</dl>
<p>Temperatures and pressures can also be defined by <code class="docutils literal notranslate"><span class="pre">self.thermodynamics</span></code>,
whose entries always cover the entries here.</p>
<p>Phonon dispersions are forced to be summed if the automatic scheme
(<code class="docutils literal notranslate"><span class="pre">autocalc=True</span></code>) is launched. To get verbose outputs, call
<code class="docutils literal notranslate"><span class="pre">self.thermodynamics()</span></code> first and then call <code class="docutils literal notranslate"><span class="pre">self.print_results()</span></code>.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ha</span> <span class="o">=</span> <span class="n">Harmonic</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">pressure</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,])</span>
<span class="n">ha</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;harmonic_phonon.out&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Harmonic.from_file">
<span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scelphono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_eigvt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Harmonic.from_file" title="Link to this definition"></a></dt>
<dd><p>Generate the Harominc object from a HA output file. Imaginary modes and
overlapped q points are forced to be cleaned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_name</strong> (<em>str</em>) – Name of the output file.</p></li>
<li><p><strong>scellphono</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – The ‘SCELPHONO’ keyword in CRYSTAL input file. By default a
1*1*1 ‘SCELPHONO’ is assumed.</p></li>
<li><p><strong>read_eigvt</strong> (<em>bool</em>) – Whether to read eigenvectors from output.</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.structure</strong> (<em>PyMatGen Structure</em>) – Cell reduced by SCELPHONO.</p></li>
<li><p><strong>self.natom</strong> (<em>int</em>) – Number of atoms in the reduced cell.</p></li>
<li><p><strong>self.volume</strong> (<em>float</em>) – Volume of the reduced cell. Unit: Angstrom^3</p></li>
<li><p><strong>self.edft</strong> (<em>float</em>)</p></li>
<li><p><strong>self.nqpoint</strong> (<em>int</em>)</p></li>
<li><p><strong>self.qpoint</strong> (<em>list</em>)</p></li>
<li><p><strong>self.nmode</strong> (<em>array[int]</em>)</p></li>
<li><p><strong>self.mode</strong> (<em>list[Mode]</em>) – List of mode objects at all the qpoints.</p></li>
</ul>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If a QHA output file is read.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Harmonic.from_phonopy">
<span class="sig-name descname"><span class="pre">from_phonopy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phono_yaml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">struc_yaml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Harmonic.from_phonopy" title="Link to this definition"></a></dt>
<dd><p>Build a Harmonic object from <a class="reference external" href="https://phonopy.github.io/phonopy/">Phonopy</a>
‘band.yaml’ or ‘qpoints.yaml’ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phono_yaml</strong> (<em>str</em>) – Phonopy band.yaml or qpoint.yaml file</p></li>
<li><p><strong>struc_yaml</strong> (<em>str</em>) – Phonopy phonopy.yaml or phonopy_disp.yaml file.
<em>Needed only if a qpoint.yaml file is read.</em></p></li>
<li><p><strong>edft</strong> (<em>float</em>) – DFT energy. Unit: kJ/mol</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Scaling factor of phonon frequency.</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
<li><p><strong>q_id</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Specify the id (from 0) of q points to be read.
nqpoint*1 list.</p></li>
<li><p><strong>q_coord</strong> (<em>list</em><em>[</em><em>list</em><em>]</em>) – Specify the coordinates of q points to be
read. nqpoint*3 list.</p></li>
</ul>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">q_id</span></code> and <code class="docutils literal notranslate"><span class="pre">q_coord</span></code> should not be set simultaneously. If set,
<code class="docutils literal notranslate"><span class="pre">q_id</span></code> takes priority and <code class="docutils literal notranslate"><span class="pre">q_coord</span></code> is ignored. If both are none,
all the points will be read.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Exception</strong> – If the length unit in yaml file is neither ‘au’ nor ‘angstrom’.</p></li>
<li><p><strong>Exception</strong> – If q point is not found.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Harmonic.from_frequency">
<span class="sig-name descname"><span class="pre">from_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_natom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Harmonic.from_frequency" title="Link to this definition"></a></dt>
<dd><p>Generate a Harmonic object by specifying frequency and eigenvector.
Imaginary modes and overlapped q points are forced to be cleaned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edft</strong> (<em>float</em>) – Electron total energy</p></li>
<li><p><strong>qpoint</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>float</em><em>]</em><em>]</em>) – Fractional coordinate
and weight of qpoint</p></li>
<li><p><strong>frequency</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Array of frequencies. Unit: THz</p></li>
<li><p><strong>eigenvector</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Normalized eigenvectors.</p></li>
<li><p><strong>structure</strong> (<em>Pymatgen Structure</em>)</p></li>
<li><p><strong>natom</strong> (<em>int</em>)</p></li>
<li><p><strong>volume</strong> (<em>float</em>)</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
<li><p><strong>ignore_natom</strong> (<em>bool</em>) – Developer only.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user should define either <code class="docutils literal notranslate"><span class="pre">structure</span></code> or <code class="docutils literal notranslate"><span class="pre">natom</span></code> + <code class="docutils literal notranslate"><span class="pre">volume</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self.structure</strong> (<em>PyMatGen Structure</em>) – Cell reduced by SCELPHONO.</p></li>
<li><p><strong>self.natom</strong> (<em>int</em>) – Number of atoms in the reduced cell.</p></li>
<li><p><strong>self.volume</strong> (<em>float</em>) – Volume of the reduced cell. Unit: Angstrom^3</p></li>
<li><p><strong>self.edft</strong> (<em>float</em>)</p></li>
<li><p><strong>self.nqpoint</strong> (<em>int</em>)</p></li>
<li><p><strong>self.qpoint</strong> (<em>list</em>)</p></li>
<li><p><strong>self.nmode</strong> (<em>array[int]</em>)</p></li>
<li><p><strong>self.mode</strong> (<em>list[Mode]</em>) – List of mode objects at all the qpoints.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AttributeError</strong> – If computational data is stored in the object.</p></li>
<li><p><strong>ValueError</strong> – If neither of the 2 available options are defined.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Harmonic.thermodynamics">
<span class="sig-name descname"><span class="pre">thermodynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sumphonon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Harmonic.thermodynamics" title="Link to this definition"></a></dt>
<dd><p>Calculate the thermodynamic properties (zp_energy, u_vib, entropy, c_v
and Gibbs and Helmholtz free energy) of the HA system at all qpoints
and the whole temperature/pressure range.</p>
<p>Other parameters are the sum of corresponding attributes of all the
<code class="docutils literal notranslate"><span class="pre">Mode</span> <span class="pre">objects</span></code>. The Helmholtz and Gibbs free energies are defined as:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}F(p,V) = E_{DFT} + F_{vib}(T) = E_{DFT} + U_{vib}(T) - TS(T)\\G(p, V) = F + pV\end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: GPa</p></li>
<li><p><strong>sumphonon</strong> (<em>bool</em>) – Whether to sum up the phonon contributions across
the sampled q points and take weighted-average.</p></li>
<li><p><strong>mutewarning</strong> (<em>bool</em>) – Whether print out warning messages of updated
temperature and pressure (For QHA).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.helmholtz</strong> (<em>array[float]</em>) – nqpoint*ntemperature. Unit: KJ/mol</p></li>
<li><p><strong>self.gibbs</strong> (<em>array[float]</em>) – nqpoint*nPressure*nTemperature. Unit: KJ/mol</p></li>
<li><p><strong>self.zp_energy</strong> (<em>array[float]</em>) – Zero-point energy. nqpoint*1. Unit: KJ/mol</p></li>
<li><p><strong>self.u_vib</strong> (<em>array[float]</em>) – Vibrational contribution to internal
energy. nqpoint*ntemperature. Unit: KJ/mol</p></li>
<li><p><strong>self.entropy</strong> (<em>array[float]</em>) – nqpoint*ntemperature. Unit: J/mol*K</p></li>
<li><p><strong>self.c_v</strong> (<em>array[float]</em>) – Constant volume specific heat.
nqpoint*ntemperature. Unit: J/mol*K</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">sumphonon</span> <span class="pre">=</span> <span class="pre">True</span></code>, nqpoint = 1.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AttributeError</strong> – If temperature and pressure are defined neither here nor during initialization</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Harmonic.write_HA_result">
<span class="sig-name descname"><span class="pre">write_HA_result</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Harmonic.write_HA_result" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Quasi_harmonic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generate and rearrange harmonic phonons, store the fitted, volume-dependent
QHA phonon information and obtain the QHA thermodynamic properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: GPa</p></li>
<li><p><strong>write_out</strong> (<em>bool</em>) – Whether to print the key information into a file.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the output file. Valid if <code class="docutils literal notranslate"><span class="pre">write_out</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Temperatures and pressures can also be defined by <code class="docutils literal notranslate"><span class="pre">self.thermodynamics</span></code>,
whose entries always cover the entries here.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qha</span> <span class="o">=</span> <span class="n">Quasi_harmonic</span><span class="p">()</span>
<span class="n">qha</span><span class="o">.</span><span class="n">from_QHA_file</span><span class="p">(</span><span class="s1">&#39;qha_phonon.out&#39;</span><span class="p">)</span>
<span class="n">qha</span><span class="o">.</span><span class="n">thermo_freq</span><span class="p">(</span><span class="n">eos_method</span><span class="o">=</span><span class="s1">&#39;birch_murnaghan&#39;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">pressure</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.from_HA_files">
<span class="sig-name descname"><span class="pre">from_HA_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scelphono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_sort_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.from_HA_files" title="Link to this definition"></a></dt>
<dd><p>Read data from individual HA calculation outputs. Imaginary modes and
overlapped q points are forced to be cleaned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_files</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of phonon output filenames.</p></li>
<li><p><strong>scelphono</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Corresponds to the
‘SCELPHONO’ keyword in CRYSTAL. Either 3*3 or ndimension*ndimension.
By default a 1*1*1 ‘SCELPHONO’ is assumed.</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
<li><p><strong>mode_sort_tol</strong> (<em>float</em><em> | </em><em>None</em>) – The threshold of close mode
overlaps. If none, do not sort modes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self</strong> (<em>Quasi_harmonic</em>) – New Attributes listed below</p></li>
<li><p><strong>self.ncalc</strong> (<em>int</em>) – Number of HA phonon calculations.</p></li>
<li><p><strong>self.combined_phonon</strong> (<em>list[Harmonic]</em>) – List of Harmonic objects.</p></li>
<li><p><strong>self.combined_volume</strong> (<em>list[float]</em>) – Volumes. Unit: Angstrom^3</p></li>
<li><p><strong>self.combined_edft</strong> (<em>list[float]</em>) – DFT total energies. Unit: KJ/mol</p></li>
<li><p><strong>self.combined_mode</strong> (<em>list[Mode]</em>) – List of mode objects.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.from_QHA_file">
<span class="sig-name descname"><span class="pre">from_QHA_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scelphono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_sort_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.from_QHA_file" title="Link to this definition"></a></dt>
<dd><p>Read data from a single QHA calculation at Gamma point. Imaginary modes
and overlapped q points are forced to be cleaned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_files</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Only 1 QHA file is permitted.</p></li>
<li><p><strong>scelphono</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em>)</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
<li><p><strong>mode_sort_tol</strong> (<em>float</em><em> | </em><em>None</em>) – The threshold of close mode
overlaps. If none, do not sort modes.</p></li>
</ul>
</dd>
</dl>
<p>Returned attributes are consistent with <code class="docutils literal notranslate"><span class="pre">Quasi_harmonic.from_HA_files</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If multiple files are defined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.from_phonopy_files">
<span class="sig-name descname"><span class="pre">from_phonopy_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phono_yaml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">struc_yaml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.from_phonopy_files" title="Link to this definition"></a></dt>
<dd><p>Build a QHA object from <a class="reference external" href="https://phonopy.github.io/phonopy/">Phonopy</a>
‘band.yaml’ or ‘qpoints.yaml’ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phono_yaml</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – ncalc*1 list of Phonopy band.yaml or
qpoint.yaml files</p></li>
<li><p><strong>struc_yaml</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – ncalc*1 list of Phonopy phonopy.yaml or
phonopy_disp.yaml files. <em>Needed only if a qpoint.yaml file is
read.</em></p></li>
<li><p><strong>edft</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – ncalc*1 list / array of DFT energies.</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
<li><p><strong>q_id</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – See <code class="docutils literal notranslate"><span class="pre">Harmonic.from_phonopy</span></code>.</p></li>
<li><p><strong>q_coord</strong> (<em>list</em><em>[</em><em>list</em><em>]</em>) – See <code class="docutils literal notranslate"><span class="pre">Harmonic.from_phonopy</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">q_id</span></code> and <code class="docutils literal notranslate"><span class="pre">q_coord</span></code> should be set once and are applicable to
all the yaml files.</p>
</div>
<p>Returned attributes are consistent with <code class="docutils literal notranslate"><span class="pre">Quasi_harmonic.from_HA_files</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.eos_fit">
<span class="sig-name descname"><span class="pre">eos_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.eos_fit" title="Link to this definition"></a></dt>
<dd><p>Fit energy-volume relationship by equation of states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Unit: Angstrom^3</p></li>
<li><p><strong>energy</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Unit: kJ/mol</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Name of EoS used. Consistent with
<a class="reference external" href="https://pymatgen.org/pymatgen.analysis.eos.html">Pymatgen</a>.</p></li>
<li><p><strong>write_out</strong> (<em>bool</em>) – Whether to print EOS information.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – For DeltaFactor / Polynomial methods.</p></li>
<li><p><strong>min_ndata_factor</strong> (<em>int</em>) – For the NumericalEOS method.</p></li>
<li><p><strong>max_poly_order_factor</strong> (<em>int</em>) – For the NumericalEOS method.</p></li>
<li><p><strong>min_poly_order_factor</strong> (<em>int</em>) – For the NumericalEOS method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>eos</strong> (<em>Pymatgen EOS</em>) – The fitted equation of state.</p></li>
<li><p><strong>eos_method</strong> (<em>string</em>) – Name of the fitted equation of state</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.freq_polynomial_fit">
<span class="sig-name descname"><span class="pre">freq_polynomial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.freq_polynomial_fit" title="Link to this definition"></a></dt>
<dd><p>Fit phonon frequencies as polynomial functions of volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>array</em><em>[</em><em>int</em><em>]</em>) – The order of polynomials used.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.fit_order</strong> (<em>int</em>) – The optimal order of polynomial fit.</p>
</dd>
</dl>
<p>Please also refer to <code class="docutils literal notranslate"><span class="pre">self.poly_fit</span></code> and <code class="docutils literal notranslate"><span class="pre">self.poly_fit_rsquare</span></code>
attributes of Mode class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.thermo_freq">
<span class="sig-name descname"><span class="pre">thermo_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'birch_murnaghan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BFGS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.thermo_freq" title="Link to this definition"></a></dt>
<dd><p>Obtain thermodynamic properties by explicitly fitting phonon
frequencies as polynomial functions of volume. DFT total energies are
fitted as a function of volume by equation of states (EOS).</p>
<p>The equilibrium volume is fitted by minimizing Gibbs free energy at
constant temperature and pressure.</p>
<div class="math notranslate nohighlight">
\[V(T,p)=\text{min}[G(V;T,p)]=\text{min}[E_{0}(V)+F_{vib}(V;T,p)+pV)]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eos_method</strong> (<em>str</em><em>, </em><em>optional</em>) – EOS used to fit DFT total energy and
Helmholtz free energy (to get bulk modules).</p></li>
<li><p><strong>poly_order</strong> (<em>array</em><em>[</em><em>int</em><em>] </em><em>| </em><em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – The order of
polynomials used to fit frequency as the function of volumes.</p></li>
<li><p><strong>min_method</strong> (<em>string</em><em>, </em><em>optional</em>) – Minimisation algorithms.</p></li>
<li><p><strong>volume_bound</strong> (<em>tuple-like</em><em>, </em><em>optional</em>) – equilibrium volumes. Unit: Angstrom^3</p></li>
<li><p><strong>mutewarning</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether print out warning messages.</p></li>
<li><p><strong>temperature</strong> (<em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: GPa</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) – For DeltaFactor / Polynomial EOSs.</p></li>
<li><p><strong>min_ndata_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS.</p></li>
<li><p><strong>max_poly_order_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS.</p></li>
<li><p><strong>min_poly_order_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Valid entries of <code class="docutils literal notranslate"><span class="pre">eos_method</span></code> are consistent with <a class="reference external" href="https://pymatgen.org/pymatgen.analysis.eos.html">PyMatGen</a>.</p></li>
<li><dl class="simple">
<dt>Parameterized and tested algorithms for <code class="docutils literal notranslate"><span class="pre">min_method</span></code>:</dt><dd><ul class="simple">
<li><p>BFGS(no boundary)</p></li>
<li><p>L-BFGS-B(with boundary)</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> (<em>Quasi_harmonic</em>) – New Attributes listed below</p></li>
<li><p><strong>self.temperature</strong> (<em>array</em>) – Unit: K</p></li>
<li><p><strong>self.pressure</strong> (<em>array</em>) – Unit: GPa</p></li>
<li><p><strong>self.volume</strong> (<em>array</em>) – nPressure*nTemperature, same below. Equilibrium volumes. Unit: <span class="math notranslate nohighlight">\(\AA^{3}\)</span></p></li>
<li><p><strong>self.helmholtz</strong> (<em>array</em>) – Helmholtz free energy. Unit: kJ/mol</p></li>
<li><p><strong>self.gibbs</strong> (<em>array</em>) – Gibbs free energy. Unit: kJ/mol</p></li>
<li><p><strong>self.entropy</strong> (<em>array</em>) – Entropy. Unit: <span class="math notranslate nohighlight">\(J.mol^{-1}.K^{-1}\)</span></p></li>
<li><p><strong>self.c_v</strong> (<em>array</em>) – Constant volume specific heat. Unit: <span class="math notranslate nohighlight">\(J.mol^{-1}.K^{-1}\)</span></p></li>
<li><p><strong>self.e0_eos</strong> (<em>Pymatgen EOS</em>) – Pymatgen EOS object. EOS used to fit DFT energy.</p></li>
<li><p><strong>self.e0_eos_method</strong> (<em>str</em>) – Name of the EOS.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If temperature or pressure is defined neither here nor during initialization.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.thermo_gruneisen">
<span class="sig-name descname"><span class="pre">thermo_gruneisen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'birch_murnaghan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BFGS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.thermo_gruneisen" title="Link to this definition"></a></dt>
<dd><p>Grüneisen parameters and related properties. The macroscopic Grüneisen
parameter is defined as:</p>
<div class="math notranslate nohighlight">
\[\gamma=\sum_{\textbf{q}i}\frac{\gamma_{\textbf{q}i}C_{V,\textbf{q}i}}{C_{V}}\]</div>
<p>Thermal expansion coefficient in Grüneisen model:</p>
<div class="math notranslate nohighlight">
\[\alpha_{V}^{gru}=\frac{\gamma C_{V}}{K_{T}V}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Grüneisen model is used to fit frequencies, equivalent to using
<code class="docutils literal notranslate"><span class="pre">self.thermo_freq(poly_order=[1,])</span></code>.</p>
</div>
<p>For arguments, see <code class="docutils literal notranslate"><span class="pre">self.thermo_freq</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> (<em>Quasi_harmonic</em>) – New attributes listed below. Other attributes are the same as <code class="docutils literal notranslate"><span class="pre">self.thermo_freq</span></code>.</p></li>
<li><p><strong>self.gruneisen</strong> (<em>array</em>) – npressure*ntemperature, same below. Macroscopic Grüneisen parameter. Temperature should &gt; 0.</p></li>
<li><p><strong>self.alpha_vgru</strong> (<em>array</em>) – Thermal expansion coefficient by Grüneisen method.</p></li>
<li><p><strong>self.c_pgru</strong> (<em>array</em>) – Constant pressure specific heat by Grüneisen method. Unit: <span class="math notranslate nohighlight">\(J.mol^{-1}.K^{-1}\)</span></p></li>
<li><p><strong>self.k_t</strong> (<em>array</em>) – Isothermal bulk modulus. Unit: GPa.</p></li>
<li><p><strong>self.k_sgru</strong> (<em>array</em>) – Adiabatic bulk modulus by Grüneisen method. Unit: GPa.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.thermo_eos">
<span class="sig-name descname"><span class="pre">thermo_eos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'birch_murnaghan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.thermo_eos" title="Link to this definition"></a></dt>
<dd><p>Obtain thermodynamic properties by fitting EOS, which is fitted by the
Helmholtz free energies of sampled harmonic phonons. The explicit
sorting and fitting of frequency-volume relationship is disabled.</p>
<p>Entropy is obtained by taking the derivation of Gibbs free energy at
constant pressure.</p>
<div class="math notranslate nohighlight">
\[S=-\left(\frac{\partial G}{\partial T}\right)_{p}\]</div>
<p>Constant pressure specific heat is obtained by taking the second
derivative of <span class="math notranslate nohighlight">\(G\)</span>.</p>
<div class="math notranslate nohighlight">
\[C_{p}=-T\left(\frac{\partial^{2}G}{\partial T^{2}}\right)_{p}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">poly_order</span></code> should &gt;= 2.</p>
</div>
<p>For arguments, see <code class="docutils literal notranslate"><span class="pre">self.thermo_freq</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> (<em>Quasi_harmonic</em>) – New attributes listed below</p></li>
<li><p><strong>self.temperature</strong> (<em>array</em>) – Unit: K</p></li>
<li><p><strong>self.pressure</strong> (<em>array</em>) – Unit: GPa</p></li>
<li><p><strong>self.volume</strong> (<em>array</em>) – nPressure*nTemperature, same below. Equilibrium volumes. Unit: <span class="math notranslate nohighlight">\(\AA^{3}\)</span></p></li>
<li><p><strong>self.helmholtz</strong> (<em>array</em>) – Helmholtz free energy. Unit: kJ/mol</p></li>
<li><p><strong>self.gibbs</strong> (<em>array</em>) – Gibbs free energy. Unit: kJ/mol</p></li>
<li><p><strong>self.entropy</strong> (<em>array</em>) – Entropy. Unit: <span class="math notranslate nohighlight">\(J.mol^{-1}.K^{-1}\)</span></p></li>
<li><p><strong>self.c_p</strong> (<em>array</em>) – Constant pressure specific heat. Unit: <span class="math notranslate nohighlight">\(J.mol^{-1}.K^{-1}\)</span></p></li>
<li><p><strong>self.fe_eos</strong> (<em>list[Pymatgen EOS]</em>) – nTemperature*1 list of Pymatgen EOS objects. EOSs used to fit HA free energy at constant temperature.</p></li>
<li><p><strong>self.fe_eos_method</strong> (<em>str</em>) – The name of EOS used.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> – If the number of HA calculations is less than 4.</p></li>
<li><p><strong>ValueError</strong> – If temperature or pressure is defined neither here nor during initialization.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.expansion_vol">
<span class="sig-name descname"><span class="pre">expansion_vol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'expansion_fit.png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.expansion_vol" title="Link to this definition"></a></dt>
<dd><p>Fit the thermal expansion curve and get thermal expansion coefficients
at equilibrium volumes.</p>
<p>The volumetric thermal expansion coefficient at constant pressure:</p>
<div class="math notranslate nohighlight">
\[\alpha_{V}(T) = \frac{1}{V(T)}\left(\frac{\partial V(T)}{\partial T}\right)_{p}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>poly_order</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – <em>method = ‘polynomial’</em>, order of polynomials.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – Plot V-T curves to examine the goodness of fitting. An
interactive window will pump out to let user to specify the
optimial fitting.</p></li>
<li><p><strong>fit_fig</strong> (<em>str</em>) – File name for fittings. A temperal figure is printed
to help the user choose the optimal fitting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self</strong> (<em>Quasi_harmonic</em>) – New attributes listed below</p></li>
<li><p><strong>self.vol_fit</strong> (<em>list</em>) – nPressure*1. List of Numpy polynomial object, the fitted volume V(T)</p></li>
<li><p><strong>self.alpha_v</strong> (<em>array</em>) – nPressure*nTemperature. Expansion coefficients at equilibrium volumes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.bulk_modulus">
<span class="sig-name descname"><span class="pre">bulk_modulus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adiabatic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.bulk_modulus" title="Link to this definition"></a></dt>
<dd><p>Calculate isothermal and adiabatic bulk moduli at equilibrium volumes.</p>
<p>The following equations are used:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}K_{T}(p;T) = V(p;T)\left(\frac{\partial^{2}F(V;T)}{\partial V^{2}}\right)_{T}\\K_{S} = K_{T} + \frac{\alpha^{2}_{V}VTK^{2}_{T}}{C_{V}}\end{aligned}\end{align} \]</div>
<p>To get <span class="math notranslate nohighlight">\(K_{T}\)</span>, Helmholtz free energy is fit as isothermal EOSs.
For <code class="docutils literal notranslate"><span class="pre">self.thermo_eos()</span></code>, that means doing nothing; For
<code class="docutils literal notranslate"><span class="pre">self.thermo_freq()</span></code>, EOS fitting is required, whose form is the same
as EOS used for <span class="math notranslate nohighlight">\(E_{0}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adiabatic</strong> (<em>bool</em>) – Whether to fit adiabatic bulk modulus. Thermal
expansion coefficient needed.</p></li>
<li><p><strong>order</strong> – (int, optional): To restore EOS.</p></li>
<li><p><strong>min_ndata_factor</strong> – (int, optional): To restore EOS.</p></li>
<li><p><strong>max_poly_order_factor</strong> – (int, optional): To restore EOS.</p></li>
<li><p><strong>min_poly_order_factor</strong> – (int, optional): To restore EOS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self</strong> (<em>Quasi_harmonic</em>) – New attributes listed below</p></li>
<li><p><strong>self.k_t</strong> (<em>array</em>) – nPressure*nTemperature, same below. Isothermal bulk modulus. Unit: GPa.</p></li>
<li><p><strong>self.k_s</strong> (<em>array</em>) – Adiabatic bulk modulus. Unit: GPa.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.specific_heat">
<span class="sig-name descname"><span class="pre">specific_heat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.specific_heat" title="Link to this definition"></a></dt>
<dd><p>Calculate constant volume or pressure specific heat at equilibrium
volumes.</p>
<p>The following equation is used:</p>
<div class="math notranslate nohighlight">
\[C_{p} - C_{V} = \alpha_{V}^{2}K_{T}VT\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> (<em>Quasi_harmonic</em>) – New attributes listed below</p></li>
<li><p><strong>self.c_v</strong> (<em>array</em>) – nPressure*nTemperature, same below. Constant volume specific heat. Unit: <span class="math notranslate nohighlight">\(J.mol^{-1}.K^{-1}\)</span></p></li>
<li><p><strong>self.c_p</strong> (<em>array</em>) – Constant pressure specific heat. Unit: <span class="math notranslate nohighlight">\(J.mol^{-1}.K^{-1}\)</span></p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method fits <code class="docutils literal notranslate"><span class="pre">self.c_p</span></code> by <code class="docutils literal notranslate"><span class="pre">self.c_v</span></code> when <code class="docutils literal notranslate"><span class="pre">thermo_freq</span></code>
and <code class="docutils literal notranslate"><span class="pre">thermo_gruneisen</span></code> was used. <code class="docutils literal notranslate"><span class="pre">self.c_v</span></code> is obtained by when
<code class="docutils literal notranslate"><span class="pre">thermo_eos</span></code> is used.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Quasi_harmonic.expansion_lin">
<span class="sig-name descname"><span class="pre">expansion_lin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Quasi_harmonic.expansion_lin" title="Link to this definition"></a></dt>
<dd><p>Fit linear expansions of lattice parameters by the 2-order Taylor
expansion.</p>
<div class="math notranslate nohighlight">
\[G(\mathbf{p})=G_{0}(\mathbf{p_{0}})+\Delta\mathbf{p}^{T}\mathbf{H}\Delta\mathbf{p}\]</div>
<p>:math::<cite>G</cite> is Gibbs free energy. <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> is the vector
of lattice parameters. <span class="math notranslate nohighlight">\(\Delta\mathbf{p}\)</span> means the
difference between the fitted and equilibrium lattice parameters.
<span class="math notranslate nohighlight">\(\mathbf{H}\)</span> is the Hessian of <span class="math notranslate nohighlight">\(G\)</span> and displacements
along lattice parameters.</p>
<p>The RMS deviations (RMSD) of the following equation is minimized
at constant temperature and pressure. But deviations from
equilibrium volume might occur. RMSD of Gibbs free energy is
available in output file only.</p>
<div class="math notranslate nohighlight">
\[\mathbf{p_{0}} = \min\left\{\Delta\mathbf{p}^{T}\mathbf{H}\Delta\mathbf{p} - [G(\mathbf{p})-G_{0}(T,p)]\right\}\]</div>
<p>This method requires a larger number of HA calculations to ensure
a small RMSD. Typically the number of HA calculations should
follow the equation below, otherwise the warning massage is given.</p>
<div class="math notranslate nohighlight">
\[n_{HA} \geq n_{latt} + \sum_{i=1}^{n_{latt}}i\]</div>
<p><span class="math notranslate nohighlight">\(n_{latt}\)</span> is the lenth of the minimial set of lattice parameters.
The optimized lattice parameters at DFT level are used for fitting.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="upperalpha simple" start="14">
<li><p>Raimbault, V. Athavale and M. Rossi, <em>Phys. Rev. Materials</em>, 2019, <strong>3</strong>, 053605.</p></li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>poly_order</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Order of polynomials used to fit the
linear expansion coefficients. The optimal fit across the
sampled temperature and pressure range of a certain lattice
parameter is automatically chosen based on <span class="math notranslate nohighlight">\(R^{2}\)</span>.</p></li>
<li><p><strong>interp</strong> (<em>int</em>) – Number of interpolated geometries. All the HA
geometries are used besides the interpolated ones.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self</strong> (<em>Quasi_harmonic</em>) – New attributes listed below</p></li>
<li><p><strong>self.lattice</strong> (<em>array</em>) – nPressure*nTemperature*nLattice. The equilibrium values of minimal set of lattice parameters.</p></li>
<li><p><strong>self.latt_fit</strong> (<em>list</em>) – nPressure*nLattice. Numpy polynomial object, the fitted a(v). Linear part only.</p></li>
<li><p><strong>self.alpha_latt</strong> (<em>array</em>) – nPressure*nTemperature*nLattice. Linear expansion coefficients. Linear part only.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Phonopy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Phonopy</span></span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Phonopy" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The convertor between Phonopy and CRYSTALpytools file formats</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Phonopy.read_structure">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Phonopy.read_structure" title="Link to this definition"></a></dt>
<dd><p>Read geometry from <a class="reference external" href="https://phonopy.github.io/phonopy/">Phonopy</a>
band.yaml or phonopy.yaml or phonopy_disp.yaml files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – Phonopy yaml file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>struc</strong> (<em>Pymatgen Structure</em>)</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If the length unit in yaml file is neither ‘au’ nor ‘angstrom’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Phonopy.read_frequency">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Phonopy.read_frequency" title="Link to this definition"></a></dt>
<dd><p>Read phonon frequency from <a class="reference external" href="https://phonopy.github.io/phonopy/">Phonopy</a>
band.yaml or qpoints.yaml files. Frequency units must be THz (default
of Phonopy).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – Phonopy yaml file</p></li>
<li><p><strong>q_id</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Specify the id (from 0) of q points to be read.
nqpoint*1 list.</p></li>
<li><p><strong>q_coord</strong> (<em>list</em><em>[</em><em>list</em><em>]</em>) – Specify the coordinates of q points to be
read. nqpoint*3 list.</p></li>
</ul>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">q_id</span></code> and <code class="docutils literal notranslate"><span class="pre">q_coord</span></code> should not be set simultaneously. If set,
<code class="docutils literal notranslate"><span class="pre">q_id</span></code> takes priority and <code class="docutils literal notranslate"><span class="pre">q_coord</span></code> is ignored. If both are none,
all the points will be read.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpoint</strong> (<em>list</em>) – natom*2 list. 1st element: 3*1 array. Fractional
coordinates of q points; 2nd element: float. Weight</p></li>
<li><p><strong>frequency</strong> (<em>array</em>) – nqpint*nmode array. Phonon frequency in THz.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If (some of) q point is not found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Phonopy.write_force_constants">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_force_constants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hessfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HESSFREQ.DAT'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phonopyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'FORCE_CONSTANTS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Phonopy.write_force_constants" title="Link to this definition"></a></dt>
<dd><p>Write Phonopy/VASP FORCE_CONSTANTS file by CRYSTAL HESSFREQ.DAT file.</p>
<p>For example, to convert the calculation ‘example’ with a 4*4*4
supercelland get phonon frequencies at Gamma point, use the following
code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">CRYSTALpytools.thermodynamics</span><span class="w"> </span><span class="kn">import</span> <span class="n">Phonopy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Phonopy</span><span class="o">.</span><span class="n">write_force_constants</span><span class="p">(</span><span class="n">hessfile</span><span class="o">=</span><span class="s1">&#39;example.HESSFREQ&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phonopy</span> <span class="o">--</span><span class="n">crystal</span> <span class="o">--</span><span class="n">qpoints</span><span class="o">=</span><span class="s1">&#39;0 0 0&#39;</span> <span class="o">-</span><span class="n">c</span> <span class="n">example</span><span class="o">.</span><span class="n">out</span> <span class="o">--</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;4 4 4&#39;</span> <span class="o">--</span><span class="n">readfc</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hessfile</strong> (<em>str</em>) – The HESSFREQ.DAT file</p></li>
<li><p><strong>phonopyfile</strong> (<em>str</em>) – The output name</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Output</span></span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Deal with output data file</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_HA_result">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_HA_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_HA_result" title="Link to this definition"></a></dt>
<dd><p>Write harmonic phonon information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Harmonic" title="CRYSTALClear.thermodynamics.Harmonic"><em>Harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Harmonic</span></code> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_QHA_combinedata">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_combinedata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_QHA_combinedata" title="Link to this definition"></a></dt>
<dd><p>Write QHA combined phonon information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_QHA_sortphonon">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_sortphonon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close_overlap</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_QHA_sortphonon" title="Link to this definition"></a></dt>
<dd><p>Write QHA phonon sort information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p></li>
<li><p><strong>close_overlap</strong> (<em>array</em><em>[</em><em>int</em><em>]</em>) – nqpoint*nmode_ref*ncalc*nmode_sort.
Number of close overlaps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_QHA_eosfit">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_eosfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_QHA_eosfit" title="Link to this definition"></a></dt>
<dd><p>Write QHA phonon eos fit information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p></li>
<li><p><strong>order</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Orders of polynomials</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Name of EoS used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_QHA_polyfit">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_polyfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsquare_q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_QHA_polyfit" title="Link to this definition"></a></dt>
<dd><p>Write QHA phonon polynomial fit information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p></li>
<li><p><strong>order</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – List of polynomial orders.</p></li>
<li><p><strong>rsquare_q</strong> (<em>array</em>) – Nqpoint*Norder list. Overall goodness at a q point.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_QHA_thermofreq">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_thermofreq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_bound</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_QHA_thermofreq" title="Link to this definition"></a></dt>
<dd><p>Write QHA thermodynamics information (frequency fitting).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_QHA_thermogru">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_thermogru</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_QHA_thermogru" title="Link to this definition"></a></dt>
<dd><p>Write QHA thermodynamics information (Grüneisen fitting).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_QHA_thermoeos">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_thermoeos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_QHA_thermoeos" title="Link to this definition"></a></dt>
<dd><p>Write QHA thermodynamics information (EOS fitting).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_expansion_vol">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_expansion_vol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_rs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_expansion_vol" title="Link to this definition"></a></dt>
<dd><p>Write volumetric thermal expansions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p></li>
<li><p><strong>fit_order</strong> (<em>int</em>) – The order of polynomial used for fitting.</p></li>
<li><p><strong>fit_rs</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – R^2 of fitting. nPressure*1 list.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_bulk_modulus">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_bulk_modulus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adiabatic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_bulk_modulus" title="Link to this definition"></a></dt>
<dd><p>Write bulk moduli.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code></dt><dd><p>object.</p>
</dd>
<dt>adiabatic (bool): Whether the adiabatic bulk modulus <span class="math notranslate nohighlight">\(K_{S}\)</span></dt><dd><p>is fitted.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_specific_heat">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_specific_heat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_specific_heat" title="Link to this definition"></a></dt>
<dd><p>Write bulk moduli.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALClear.thermodynamics.Output.write_expansion_latt">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_expansion_latt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_square</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.thermodynamics.Output.write_expansion_latt" title="Link to this definition"></a></dt>
<dd><p>Write linear expansion information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALClear.thermodynamics.Quasi_harmonic" title="CRYSTALClear.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p></li>
<li><p><strong>e_err</strong> (<em>array</em>) – RMS deviation of Gibbs free energy at T and p.</p></li>
<li><p><strong>fit_order</strong> (<em>array</em>) – The order of polynomials used for fitting
lattice parameter.</p></li>
<li><p><strong>r_square</strong> (<em>array</em>) – R^2 of fitting. nLatt*nPress</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-CRYSTALClear.unit_test">
<span id="crystalclear-unit-test"></span><h2>CRYSTALClear.unit_test<a class="headerlink" href="#module-CRYSTALClear.unit_test" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.unit_test.crystal_input_test">
<span class="sig-name descname"><span class="pre">crystal_input_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.unit_test.crystal_input_test" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.unit_test.crystal_output_test">
<span class="sig-name descname"><span class="pre">crystal_output_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.unit_test.crystal_output_test" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.unit_test.convert_test">
<span class="sig-name descname"><span class="pre">convert_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.unit_test.convert_test" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.unit_test.test_all">
<span class="sig-name descname"><span class="pre">test_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.unit_test.test_all" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-CRYSTALClear.units">
<span id="crystalclear-units"></span><h2>CRYSTALClear.units<a class="headerlink" href="#module-CRYSTALClear.units" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.H_to_eV">
<span class="sig-name descname"><span class="pre">H_to_eV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.H_to_eV" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.eV_to_H">
<span class="sig-name descname"><span class="pre">eV_to_H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.eV_to_H" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.H_to_kjmol">
<span class="sig-name descname"><span class="pre">H_to_kjmol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.H_to_kjmol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.kjmol_to_H">
<span class="sig-name descname"><span class="pre">kjmol_to_H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.kjmol_to_H" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.au_to_angstrom">
<span class="sig-name descname"><span class="pre">au_to_angstrom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.au_to_angstrom" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.angstrom_to_au">
<span class="sig-name descname"><span class="pre">angstrom_to_au</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.angstrom_to_au" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.cm_to_thz">
<span class="sig-name descname"><span class="pre">cm_to_thz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.cm_to_thz" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.thz_to_cm">
<span class="sig-name descname"><span class="pre">thz_to_cm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.thz_to_cm" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.hartree_to_thz">
<span class="sig-name descname"><span class="pre">hartree_to_thz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.hartree_to_thz" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.thz_to_hartree">
<span class="sig-name descname"><span class="pre">thz_to_hartree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.thz_to_hartree" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.amu_to_me">
<span class="sig-name descname"><span class="pre">amu_to_me</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.amu_to_me" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALClear.units.me_to_amu">
<span class="sig-name descname"><span class="pre">me_to_amu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALClear.units.me_to_amu" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usage.html" class="btn btn-neutral float-left" title="Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cite.html" class="btn btn-neutral float-right" title="How to Cite CRYSTALClear" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, CRYSTALClear Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>